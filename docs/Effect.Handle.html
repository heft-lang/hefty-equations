<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Effect.Handle</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--without-K</a> <a id="25" class="Symbol">#-}</a> 

<a id="31" class="Keyword">open</a> <a id="36" class="Keyword">import</a> <a id="43" href="Relation.Unary.html" class="Module">Relation.Unary</a>

<a id="59" class="Keyword">open</a> <a id="64" class="Keyword">import</a> <a id="71" href="Core.Functor.html" class="Module">Core.Functor</a>
<a id="84" class="Keyword">open</a> <a id="89" class="Keyword">import</a> <a id="96" href="Core.Functor.NaturalTransformation.html" class="Module">Core.Functor.NaturalTransformation</a>
<a id="131" class="Keyword">open</a> <a id="136" class="Keyword">import</a> <a id="143" href="Core.Functor.Monad.html" class="Module">Core.Functor.Monad</a>

<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Core.Container.html" class="Module">Core.Container</a>
<a id="190" class="Keyword">open</a> <a id="195" class="Keyword">import</a> <a id="202" href="Core.Signature.html" class="Module">Core.Signature</a>
<a id="217" class="Keyword">open</a> <a id="222" class="Keyword">import</a> <a id="229" href="Core.Extensionality.html" class="Module">Core.Extensionality</a>
<a id="249" class="Keyword">open</a> <a id="254" class="Keyword">import</a> <a id="261" href="Core.Ternary.html" class="Module">Core.Ternary</a>

<a id="275" class="Keyword">open</a> <a id="280" class="Keyword">import</a> <a id="287" href="Effect.Base.html" class="Module">Effect.Base</a>
<a id="299" class="Keyword">open</a> <a id="304" class="Keyword">import</a> <a id="311" href="Effect.Syntax.Free.html" class="Module">Effect.Syntax.Free</a>

<a id="331" class="Keyword">open</a> <a id="336" class="Keyword">import</a> <a id="343" href="Data.Empty.html" class="Module">Data.Empty</a> 
<a id="355" class="Keyword">open</a> <a id="360" class="Keyword">import</a> <a id="367" href="Data.Product.html" class="Module">Data.Product</a>
<a id="380" class="Keyword">open</a> <a id="385" class="Keyword">import</a> <a id="392" href="Data.Sum.html" class="Module">Data.Sum</a>

<a id="402" class="Keyword">open</a> <a id="407" class="Keyword">import</a> <a id="414" href="Effect.Relation.Ternary.FirstOrderSeparation.html" class="Module">Effect.Relation.Ternary.FirstOrderSeparation</a>
<a id="459" class="Keyword">open</a> <a id="464" class="Keyword">import</a> <a id="471" href="Effect.Relation.Binary.FirstOrderInclusion.html" class="Module">Effect.Relation.Binary.FirstOrderInclusion</a>

<a id="515" class="Keyword">open</a> <a id="520" class="Keyword">import</a> <a id="527" href="Function.html" class="Module">Function</a> <a id="536" class="Keyword">hiding</a> <a id="543" class="Symbol">(</a><a id="544" href="Function.Bundles.html#12039" class="Function Operator">_⇔_</a><a id="547" class="Symbol">)</a>

<a id="550" class="Keyword">open</a> <a id="555" class="Keyword">import</a> <a id="562" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="578" class="Keyword">using</a> <a id="584" class="Symbol">(</a><a id="585" href="Relation.Binary.Bundles.html#2121" class="Record">Preorder</a><a id="593" class="Symbol">)</a>
<a id="595" class="Keyword">open</a> <a id="600" class="Keyword">import</a> <a id="607" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="645" class="Keyword">renaming</a> <a id="654" class="Symbol">(</a><a id="655" href="Relation.Binary.PropositionalEquality.html#4403" class="InductiveConstructor Operator">[_]</a> <a id="659" class="Symbol">to</a> <a id="662" class="InductiveConstructor Operator">≡[_]</a><a id="666" class="Symbol">)</a> <a id="668" class="Keyword">hiding</a> <a id="675" class="Symbol">(</a><a id="676" href="Relation.Binary.PropositionalEquality.html#2196" class="Function">naturality</a><a id="686" class="Symbol">)</a>

<a id="689" class="Keyword">module</a> <a id="696" href="Effect.Handle.html" class="Module">Effect.Handle</a> <a id="710" class="Keyword">where</a>

<a id="717" class="Keyword">open</a> <a id="722" href="Function.Bundles.html#7340" class="Module">Inverse</a>
<a id="730" class="Keyword">open</a> <a id="735" href="Effect.Relation.Ternary.FirstOrderSeparation.html#520" class="Module">Union</a>

<a id="742" class="Comment">{- Semantics for 1st order effects -}</a>


<a id="782" class="Comment">-- Reordering of effect rows in an effect tree according to a given separation witness.</a>
<a id="870" class="Comment">--</a>
<a id="873" class="Comment">-- Reordering is a monad morphism between the respective free monads, so it</a>
<a id="949" class="Comment">-- respects the monadic structure of Free</a>
<a id="991" class="Keyword">module</a> <a id="998" href="Effect.Handle.html#998" class="Module">_</a> <a id="1000" class="Keyword">where</a> 

  <a id="1010" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="1018" class="Symbol">:</a> <a id="1020" href="Effect.Base.html#921" class="Generalizable">ε₁</a> <a id="1023" href="Core.Ternary.html#767" class="Field Operator">∙</a> <a id="1025" href="Effect.Base.html#924" class="Generalizable">ε₂</a> <a id="1028" href="Core.Ternary.html#767" class="Field Operator">≈</a> <a id="1030" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="1033" class="Symbol">→</a> <a id="1035" href="Relation.Unary.html#3629" class="Function">∀[</a> <a id="1038" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="1043" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="1046" href="Relation.Unary.html#4621" class="Function Operator">⇒</a> <a id="1048" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="1053" class="Symbol">(</a><a id="1054" href="Effect.Base.html#921" class="Generalizable">ε₁</a> <a id="1057" href="Core.Container.html#942" class="Function Operator">⊕ᶜ</a> <a id="1060" href="Effect.Base.html#924" class="Generalizable">ε₂</a><a id="1062" class="Symbol">)</a> <a id="1064" href="Relation.Unary.html#3629" class="Function">]</a>
  <a id="1068" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="1076" href="Effect.Handle.html#1076" class="Bound">σ</a> <a id="1078" class="Symbol">=</a> <a id="1080" href="Effect.Syntax.Free.html#1715" class="Function">hmap-free</a> <a id="1090" class="Symbol">(</a><a id="1091" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1070" class="Function">Union.proj</a> <a id="1102" href="Effect.Handle.html#1076" class="Bound">σ</a><a id="1103" class="Symbol">)</a>

  <a id="1108" href="Effect.Handle.html#1108" class="Function">reorder⁻¹</a> <a id="1118" class="Symbol">:</a> <a id="1120" href="Effect.Base.html#921" class="Generalizable">ε₁</a> <a id="1123" href="Core.Ternary.html#767" class="Field Operator">∙</a> <a id="1125" href="Effect.Base.html#924" class="Generalizable">ε₂</a> <a id="1128" href="Core.Ternary.html#767" class="Field Operator">≈</a> <a id="1130" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="1133" class="Symbol">→</a> <a id="1135" href="Relation.Unary.html#3629" class="Function">∀[</a> <a id="1138" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="1143" class="Symbol">(</a><a id="1144" href="Effect.Base.html#921" class="Generalizable">ε₁</a> <a id="1147" href="Core.Container.html#942" class="Function Operator">⊕ᶜ</a> <a id="1150" href="Effect.Base.html#924" class="Generalizable">ε₂</a><a id="1152" class="Symbol">)</a> <a id="1154" href="Relation.Unary.html#4621" class="Function Operator">⇒</a> <a id="1156" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="1161" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="1164" href="Relation.Unary.html#3629" class="Function">]</a>
  <a id="1168" href="Effect.Handle.html#1108" class="Function">reorder⁻¹</a> <a id="1178" href="Effect.Handle.html#1178" class="Bound">σ</a> <a id="1180" class="Symbol">=</a> <a id="1182" href="Effect.Syntax.Free.html#1715" class="Function">hmap-free</a> <a id="1192" class="Symbol">(</a><a id="1193" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1131" class="Function">Union.proj⁻¹</a> <a id="1206" href="Effect.Handle.html#1178" class="Bound">σ</a><a id="1207" class="Symbol">)</a>

  <a id="1212" href="Effect.Handle.html#1212" class="Function">reorder-inv</a> <a id="1224" class="Symbol">:</a> <a id="1226" class="Symbol">(</a><a id="1227" href="Effect.Handle.html#1227" class="Bound">σ</a> <a id="1229" class="Symbol">:</a> <a id="1231" href="Effect.Base.html#921" class="Generalizable">ε₁</a> <a id="1234" href="Core.Ternary.html#767" class="Field Operator">∙</a> <a id="1236" href="Effect.Base.html#924" class="Generalizable">ε₂</a> <a id="1239" href="Core.Ternary.html#767" class="Field Operator">≈</a> <a id="1241" href="Effect.Base.html#930" class="Generalizable">ε′</a><a id="1243" class="Symbol">)</a> <a id="1245" class="Symbol">→</a> <a id="1247" class="Symbol">(</a><a id="1248" href="Effect.Handle.html#1248" class="Bound">m</a> <a id="1250" class="Symbol">:</a> <a id="1252" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="1257" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="1260" href="Core.Functor.html#1514" class="Generalizable">A</a><a id="1261" class="Symbol">)</a> <a id="1263" class="Symbol">→</a> <a id="1265" href="Effect.Handle.html#1108" class="Function">reorder⁻¹</a> <a id="1275" href="Effect.Handle.html#1227" class="Bound">σ</a> <a id="1277" class="Symbol">(</a><a id="1278" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="1286" href="Effect.Handle.html#1227" class="Bound">σ</a> <a id="1288" href="Effect.Handle.html#1248" class="Bound">m</a><a id="1289" class="Symbol">)</a> <a id="1291" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="1293" href="Effect.Handle.html#1248" class="Bound">m</a>
  <a id="1297" href="Effect.Handle.html#1212" class="Function">reorder-inv</a> <a id="1309" class="Symbol">{</a><a id="1310" class="Argument">ε₁</a> <a id="1313" class="Symbol">=</a> <a id="1315" href="Effect.Handle.html#1315" class="Bound">ε₁</a><a id="1317" class="Symbol">}</a> <a id="1319" class="Symbol">{</a><a id="1320" class="Argument">ε₂</a> <a id="1323" class="Symbol">=</a> <a id="1325" href="Effect.Handle.html#1325" class="Bound">ε₂</a><a id="1327" class="Symbol">}</a> <a id="1329" class="Symbol">{</a><a id="1330" class="Argument">A</a> <a id="1332" class="Symbol">=</a> <a id="1334" href="Effect.Handle.html#1334" class="Bound">A</a><a id="1335" class="Symbol">}</a> <a id="1337" href="Effect.Handle.html#1337" class="Bound">σ</a> <a id="1339" href="Effect.Handle.html#1339" class="Bound">m</a> <a id="1341" class="Symbol">=</a>
    <a id="1347" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
      <a id="1359" href="Effect.Handle.html#1108" class="Function">reorder⁻¹</a> <a id="1369" href="Effect.Handle.html#1337" class="Bound">σ</a> <a id="1371" class="Symbol">(</a><a id="1372" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="1380" href="Effect.Handle.html#1337" class="Bound">σ</a> <a id="1382" href="Effect.Handle.html#1339" class="Bound">m</a><a id="1383" class="Symbol">)</a>
    <a id="1389" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a> 
      <a id="1400" href="Effect.Syntax.Free.html#1715" class="Function">hmap-free</a> <a id="1410" class="Symbol">(</a><a id="1411" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1131" class="Function">Union.proj⁻¹</a> <a id="1424" href="Effect.Handle.html#1337" class="Bound">σ</a><a id="1425" class="Symbol">)</a> <a id="1427" class="Symbol">(</a><a id="1428" href="Effect.Syntax.Free.html#1715" class="Function">hmap-free</a> <a id="1438" class="Symbol">(</a><a id="1439" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1070" class="Function">Union.proj</a> <a id="1450" href="Effect.Handle.html#1337" class="Bound">σ</a><a id="1451" class="Symbol">)</a> <a id="1453" href="Effect.Handle.html#1339" class="Bound">m</a><a id="1454" class="Symbol">)</a>
    <a id="1460" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="1463" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">sym</a> <a id="1467" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="1469" href="Effect.Syntax.Free.html#5111" class="Function">hmap-∘</a> <a id="1476" class="Symbol">{</a><a id="1477" class="Argument">B</a> <a id="1479" class="Symbol">=</a> <a id="1481" href="Core.Container.html#676" class="Record Operator">⟦</a> <a id="1483" href="Effect.Handle.html#1315" class="Bound">ε₁</a> <a id="1486" href="Core.Container.html#676" class="Record Operator">⟧ᶜ</a> <a id="1489" href="Effect.Handle.html#1334" class="Bound">A</a><a id="1490" class="Symbol">}</a> <a id="1492" class="Symbol">{</a><a id="1493" class="Argument">D</a> <a id="1495" class="Symbol">=</a> <a id="1497" href="Core.Container.html#676" class="Record Operator">⟦</a> <a id="1499" href="Effect.Handle.html#1325" class="Bound">ε₂</a> <a id="1502" href="Core.Container.html#676" class="Record Operator">⟧ᶜ</a> <a id="1505" href="Effect.Handle.html#1334" class="Bound">A</a><a id="1506" class="Symbol">}</a> <a id="1508" href="Effect.Handle.html#1339" class="Bound">m</a> <a id="1510" class="Symbol">(</a><a id="1511" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1070" class="Function">Union.proj</a> <a id="1522" href="Effect.Handle.html#1337" class="Bound">σ</a><a id="1523" class="Symbol">)</a> <a id="1525" class="Symbol">(</a><a id="1526" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1131" class="Function">Union.proj⁻¹</a> <a id="1539" href="Effect.Handle.html#1337" class="Bound">σ</a><a id="1540" class="Symbol">)</a> <a id="1542" class="Symbol">(</a><a id="1543" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1194" class="Function">proj-natural</a> <a id="1556" href="Effect.Handle.html#1337" class="Bound">σ</a><a id="1557" class="Symbol">)</a> <a id="1559" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a> 
      <a id="1568" href="Effect.Syntax.Free.html#1715" class="Function">hmap-free</a> <a id="1578" class="Symbol">(</a><a id="1579" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1131" class="Function">Union.proj⁻¹</a> <a id="1592" href="Effect.Handle.html#1337" class="Bound">σ</a> <a id="1594" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="1596" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1070" class="Function">Union.proj</a> <a id="1607" href="Effect.Handle.html#1337" class="Bound">σ</a> <a id="1609" class="Symbol">)</a> <a id="1611" href="Effect.Handle.html#1339" class="Bound">m</a>
    <a id="1617" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="1620" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="1625" class="Symbol">(λ</a> <a id="1628" href="Effect.Handle.html#1628" class="Bound">○</a> <a id="1630" class="Symbol">→</a> <a id="1632" href="Effect.Syntax.Free.html#1715" class="Function">hmap-free</a> <a id="1642" class="Symbol">(λ</a> <a id="1645" class="Symbol">{</a><a id="1646" href="Effect.Handle.html#1646" class="Bound">A</a><a id="1647" class="Symbol">}</a> <a id="1649" class="Symbol">→</a> <a id="1651" href="Effect.Handle.html#1628" class="Bound">○</a> <a id="1653" href="Effect.Handle.html#1646" class="Bound">A</a><a id="1654" class="Symbol">)</a> <a id="1656" href="Effect.Handle.html#1339" class="Bound">m</a> <a id="1658" class="Symbol">)</a> <a id="1660" class="Symbol">(</a><a id="1661" href="Core.Extensionality.html#365" class="Function">pfext</a> <a id="1667" class="Symbol">_</a> <a id="1669" class="Symbol">_</a> <a id="1671" class="Symbol">λ</a> <a id="1673" href="Effect.Handle.html#1673" class="Bound">X</a> <a id="1675" class="Symbol">→</a> <a id="1677" href="Core.Extensionality.html#201" class="Function">extensionality</a> <a id="1692" class="Symbol">λ</a> <a id="1694" href="Effect.Handle.html#1694" class="Bound">x</a> <a id="1696" class="Symbol">→</a> <a id="1698" href="Effect.Relation.Ternary.FirstOrderSeparation.html#570" class="Field">Union.union</a> <a id="1710" href="Effect.Handle.html#1337" class="Bound">σ</a> <a id="1712" class="Symbol">.</a><a id="1713" href="Core.Container.html#1779" class="Field">equivalence</a> <a id="1725" href="Effect.Handle.html#1673" class="Bound">X</a> <a id="1727" class="Symbol">.</a><a id="1728" href="Function.Bundles.html#7526" class="Field">inverse</a> <a id="1736" class="Symbol">.</a><a id="1737" href="Data.Product.Base.html#636" class="Field">proj₁</a> <a id="1743" class="Symbol">{</a><a id="1744" class="Argument">x</a> <a id="1746" class="Symbol">=</a> <a id="1748" href="Effect.Handle.html#1694" class="Bound">x</a><a id="1749" class="Symbol">}</a> <a id="1751" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="1755" class="Symbol">)</a> <a id="1757" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a> 
      <a id="1766" href="Effect.Syntax.Free.html#1715" class="Function">hmap-free</a> <a id="1776" href="Function.Base.html#704" class="Function">id</a> <a id="1779" href="Effect.Handle.html#1339" class="Bound">m</a>
    <a id="1785" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="1788" href="Effect.Syntax.Free.html#4937" class="Function">hmap-id</a> <a id="1796" href="Effect.Handle.html#1339" class="Bound">m</a> <a id="1798" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a>
      <a id="1806" href="Effect.Handle.html#1339" class="Bound">m</a>
    <a id="1812" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
    <a id="1818" class="Keyword">where</a> <a id="1824" class="Keyword">open</a> <a id="1829" href="Relation.Binary.PropositionalEquality.Properties.html#6744" class="Module">≡-Reasoning</a>

  <a id="1844" href="Effect.Handle.html#1844" class="Function">reorder-coherent</a> <a id="1861" class="Symbol">:</a>
    <a id="1867" class="Symbol">∀</a> <a id="1869" class="Symbol">(</a><a id="1870" href="Effect.Handle.html#1870" class="Bound">m</a> <a id="1872" class="Symbol">:</a> <a id="1874" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="1879" href="Effect.Base.html#919" class="Generalizable">ε</a> <a id="1881" href="Core.Functor.html#1514" class="Generalizable">A</a><a id="1882" class="Symbol">)</a> <a id="1884" class="Symbol">(</a><a id="1885" href="Effect.Handle.html#1885" class="Bound">k</a> <a id="1887" class="Symbol">:</a> <a id="1889" href="Core.Functor.html#1514" class="Generalizable">A</a> <a id="1891" class="Symbol">→</a> <a id="1893" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="1898" href="Effect.Base.html#919" class="Generalizable">ε</a> <a id="1900" href="Core.Functor.html#1533" class="Generalizable">B</a><a id="1901" class="Symbol">)</a>
    <a id="1907" class="Symbol">→</a> <a id="1909" class="Symbol">(</a><a id="1910" href="Effect.Handle.html#1910" class="Bound">σ</a> <a id="1912" class="Symbol">:</a> <a id="1914" href="Effect.Base.html#921" class="Generalizable">ε₁</a> <a id="1917" href="Core.Ternary.html#767" class="Field Operator">∙</a> <a id="1919" href="Effect.Base.html#924" class="Generalizable">ε₂</a> <a id="1922" href="Core.Ternary.html#767" class="Field Operator">≈</a> <a id="1924" href="Effect.Base.html#919" class="Generalizable">ε</a><a id="1925" class="Symbol">)</a>
      <a id="1933" class="Comment">---------------------------------------------------</a>
    <a id="1989" class="Symbol">→</a> <a id="1991" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="1999" href="Effect.Handle.html#1910" class="Bound">σ</a> <a id="2001" class="Symbol">(</a><a id="2002" href="Effect.Handle.html#1870" class="Bound">m</a> <a id="2004" href="Core.Functor.Monad.html#423" class="Function Operator">&gt;&gt;=</a> <a id="2008" href="Effect.Handle.html#1885" class="Bound">k</a><a id="2009" class="Symbol">)</a> <a id="2011" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="2013" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="2021" href="Effect.Handle.html#1910" class="Bound">σ</a> <a id="2023" href="Effect.Handle.html#1870" class="Bound">m</a> <a id="2025" href="Core.Functor.Monad.html#423" class="Function Operator">&gt;&gt;=</a> <a id="2029" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="2037" href="Effect.Handle.html#1910" class="Bound">σ</a> <a id="2039" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2041" href="Effect.Handle.html#1885" class="Bound">k</a>
  <a id="2045" href="Effect.Handle.html#1844" class="Function">reorder-coherent</a> <a id="2062" class="Symbol">(</a><a id="2063" href="Effect.Syntax.Free.html#529" class="InductiveConstructor">pure</a> <a id="2068" href="Effect.Handle.html#2068" class="Bound">x</a><a id="2069" class="Symbol">)</a>           <a id="2081" href="Effect.Handle.html#2081" class="Bound">k</a> <a id="2083" href="Effect.Handle.html#2083" class="Bound">σ</a> <a id="2085" class="Symbol">=</a> <a id="2087" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="2094" href="Effect.Handle.html#1844" class="Function">reorder-coherent</a> <a id="2111" class="Symbol">{</a><a id="2112" class="Argument">ε₁</a> <a id="2115" class="Symbol">=</a> <a id="2117" href="Effect.Handle.html#2117" class="Bound">ε₁</a><a id="2119" class="Symbol">}</a> <a id="2121" class="Symbol">{</a><a id="2122" class="Argument">ε₂</a> <a id="2125" class="Symbol">=</a> <a id="2127" href="Effect.Handle.html#2127" class="Bound">ε₂</a><a id="2129" class="Symbol">}</a> <a id="2131" class="Symbol">(</a><a id="2132" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="2139" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="2141" href="Effect.Handle.html#2141" class="Bound">c</a> <a id="2143" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2145" href="Effect.Handle.html#2145" class="Bound">r</a> <a id="2147" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="2148" class="Symbol">)</a> <a id="2150" href="Effect.Handle.html#2150" class="Bound">k</a> <a id="2152" href="Effect.Handle.html#2152" class="Bound">σ</a> <a id="2154" class="Symbol">=</a> 
    <a id="2161" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
      <a id="2173" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="2181" href="Effect.Handle.html#2152" class="Bound">σ</a> <a id="2183" class="Symbol">(</a><a id="2184" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="2191" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="2193" href="Effect.Handle.html#2141" class="Bound">c</a> <a id="2195" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2197" href="Effect.Handle.html#2145" class="Bound">r</a> <a id="2199" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a> <a id="2201" href="Core.Functor.Monad.html#423" class="Function Operator">&gt;&gt;=</a> <a id="2205" href="Effect.Handle.html#2150" class="Bound">k</a><a id="2206" class="Symbol">)</a>
    <a id="2212" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a> 
      <a id="2223" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="2230" class="Symbol">(</a><a id="2231" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1070" class="Function">Union.proj</a> <a id="2242" href="Effect.Handle.html#2152" class="Bound">σ</a> <a id="2244" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="2246" class="Symbol">(</a><a id="2247" href="Effect.Handle.html#2141" class="Bound">c</a> <a id="2249" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2251" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="2259" href="Effect.Handle.html#2152" class="Bound">σ</a> <a id="2261" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2263" class="Symbol">(</a><a id="2264" href="Effect.Handle.html#2145" class="Bound">r</a> <a id="2266" href="Core.Functor.Monad.html#475" class="Function Operator">&gt;=&gt;</a> <a id="2270" href="Effect.Handle.html#2150" class="Bound">k</a><a id="2271" class="Symbol">))</a> <a id="2274" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="2275" class="Symbol">)</a>
    <a id="2281" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="2284" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="2289" class="Symbol">(λ</a> <a id="2292" href="Effect.Handle.html#2292" class="Bound">○</a> <a id="2294" class="Symbol">→</a> <a id="2296" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="2303" class="Symbol">(</a><a id="2304" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1070" class="Function">Union.proj</a> <a id="2315" href="Effect.Handle.html#2152" class="Bound">σ</a> <a id="2317" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="2319" href="Effect.Handle.html#2141" class="Bound">c</a> <a id="2321" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2323" href="Effect.Handle.html#2292" class="Bound">○</a> <a id="2325" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="2326" class="Symbol">))</a> <a id="2329" class="Symbol">(</a><a id="2330" href="Core.Extensionality.html#201" class="Function">extensionality</a> <a id="2345" class="Symbol">λ</a> <a id="2347" href="Effect.Handle.html#2347" class="Bound">y</a> <a id="2349" class="Symbol">→</a> <a id="2351" href="Effect.Handle.html#1844" class="Function">reorder-coherent</a> <a id="2368" class="Symbol">(</a><a id="2369" href="Effect.Handle.html#2145" class="Bound">r</a> <a id="2371" href="Effect.Handle.html#2347" class="Bound">y</a><a id="2372" class="Symbol">)</a> <a id="2374" href="Effect.Handle.html#2150" class="Bound">k</a> <a id="2376" href="Effect.Handle.html#2152" class="Bound">σ</a><a id="2377" class="Symbol">)</a> <a id="2379" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a> 
      <a id="2388" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="2395" class="Symbol">(</a><a id="2396" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1070" class="Function">proj</a> <a id="2401" href="Effect.Handle.html#2152" class="Bound">σ</a> <a id="2403" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="2405" href="Effect.Handle.html#2141" class="Bound">c</a> <a id="2407" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2409" class="Symbol">((</a><a id="2411" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="2419" href="Effect.Handle.html#2152" class="Bound">σ</a> <a id="2421" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2423" href="Effect.Handle.html#2145" class="Bound">r</a><a id="2424" class="Symbol">)</a> <a id="2426" href="Core.Functor.Monad.html#475" class="Function Operator">&gt;=&gt;</a> <a id="2430" class="Symbol">(</a><a id="2431" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="2439" href="Effect.Handle.html#2152" class="Bound">σ</a> <a id="2441" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2443" href="Effect.Handle.html#2150" class="Bound">k</a><a id="2444" class="Symbol">))</a> <a id="2447" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="2448" class="Symbol">)</a>
    <a id="2454" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="2457" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="2462" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="2469" class="Symbol">(</a><a id="2470" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1194" class="Function">proj-natural</a> <a id="2483" href="Effect.Handle.html#2152" class="Bound">σ</a> <a id="2485" class="Symbol">.</a><a id="2486" href="Core.Functor.NaturalTransformation.html#590" class="Field">commute</a> <a id="2494" class="Symbol">{</a><a id="2495" class="Argument">f</a> <a id="2497" class="Symbol">=</a> <a id="2499" href="Core.Functor.Monad.html#423" class="Function Operator">_&gt;&gt;=</a> <a id="2504" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="2512" href="Effect.Handle.html#2152" class="Bound">σ</a> <a id="2514" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2516" href="Effect.Handle.html#2150" class="Bound">k</a><a id="2517" class="Symbol">}</a> <a id="2519" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="2521" href="Effect.Handle.html#2141" class="Bound">c</a> <a id="2523" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2525" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="2533" href="Effect.Handle.html#2152" class="Bound">σ</a> <a id="2535" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2537" href="Effect.Handle.html#2145" class="Bound">r</a> <a id="2539" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="2540" class="Symbol">)</a> <a id="2542" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a> 
      <a id="2551" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="2558" class="Symbol">(</a><a id="2559" href="Core.Functor.html#495" class="Field">fmap</a> <a id="2564" class="Symbol">{</a><a id="2565" class="Argument">F</a> <a id="2567" class="Symbol">=</a> <a id="2569" href="Core.Container.html#676" class="Record Operator">⟦</a> <a id="2571" href="Effect.Handle.html#2117" class="Bound">ε₁</a> <a id="2574" href="Core.Container.html#942" class="Function Operator">⊕ᶜ</a> <a id="2577" href="Effect.Handle.html#2127" class="Bound">ε₂</a> <a id="2580" href="Core.Container.html#676" class="Record Operator">⟧ᶜ</a><a id="2582" class="Symbol">}</a> <a id="2584" class="Symbol">(</a><a id="2585" href="Core.Functor.Monad.html#423" class="Function Operator">_&gt;&gt;=</a> <a id="2590" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="2598" href="Effect.Handle.html#2152" class="Bound">σ</a> <a id="2600" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2602" href="Effect.Handle.html#2150" class="Bound">k</a><a id="2603" class="Symbol">)</a> <a id="2605" class="Symbol">(</a><a id="2606" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1070" class="Function">Union.proj</a> <a id="2617" href="Effect.Handle.html#2152" class="Bound">σ</a> <a id="2619" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="2621" href="Effect.Handle.html#2141" class="Bound">c</a> <a id="2623" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2625" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="2633" href="Effect.Handle.html#2152" class="Bound">σ</a> <a id="2635" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2637" href="Effect.Handle.html#2145" class="Bound">r</a> <a id="2639" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="2640" class="Symbol">))</a> 
    <a id="2648" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a>
      <a id="2658" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="2665" class="Symbol">(</a><a id="2666" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1070" class="Function">Union.proj</a> <a id="2677" href="Effect.Handle.html#2152" class="Bound">σ</a> <a id="2679" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="2681" href="Effect.Handle.html#2141" class="Bound">c</a> <a id="2683" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2685" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="2693" href="Effect.Handle.html#2152" class="Bound">σ</a> <a id="2695" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2697" href="Effect.Handle.html#2145" class="Bound">r</a> <a id="2699" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="2700" class="Symbol">)</a> <a id="2702" href="Core.Functor.Monad.html#423" class="Function Operator">&gt;&gt;=</a> <a id="2706" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="2714" href="Effect.Handle.html#2152" class="Bound">σ</a> <a id="2716" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2718" href="Effect.Handle.html#2150" class="Bound">k</a>
    <a id="2724" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a> 
      <a id="2735" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="2743" href="Effect.Handle.html#2152" class="Bound">σ</a> <a id="2745" class="Symbol">(</a><a id="2746" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="2753" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="2755" href="Effect.Handle.html#2141" class="Bound">c</a> <a id="2757" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2759" href="Effect.Handle.html#2145" class="Bound">r</a> <a id="2761" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="2762" class="Symbol">)</a> <a id="2764" href="Core.Functor.Monad.html#423" class="Function Operator">&gt;&gt;=</a> <a id="2768" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="2776" href="Effect.Handle.html#2152" class="Bound">σ</a> <a id="2778" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="2780" href="Effect.Handle.html#2150" class="Bound">k</a>
    <a id="2786" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
    <a id="2792" class="Keyword">where</a> <a id="2798" class="Keyword">open</a> <a id="2803" href="Relation.Binary.PropositionalEquality.Properties.html#6744" class="Module">≡-Reasoning</a>

  <a id="2818" href="Effect.Handle.html#2818" class="Function">reorder-natural</a> <a id="2834" class="Symbol">:</a> <a id="2836" class="Symbol">(</a><a id="2837" href="Effect.Handle.html#2837" class="Bound">σ</a> <a id="2839" class="Symbol">:</a> <a id="2841" href="Effect.Base.html#921" class="Generalizable">ε₁</a> <a id="2844" href="Core.Ternary.html#767" class="Field Operator">∙</a> <a id="2846" href="Effect.Base.html#924" class="Generalizable">ε₂</a> <a id="2849" href="Core.Ternary.html#767" class="Field Operator">≈</a> <a id="2851" href="Effect.Base.html#919" class="Generalizable">ε</a><a id="2852" class="Symbol">)</a> <a id="2854" class="Symbol">→</a> <a id="2856" href="Core.Functor.NaturalTransformation.html#436" class="Record">Natural</a> <a id="2864" class="Symbol">(</a><a id="2865" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="2873" href="Effect.Handle.html#2837" class="Bound">σ</a><a id="2874" class="Symbol">)</a>
  <a id="2878" href="Effect.Handle.html#2818" class="Function">reorder-natural</a> <a id="2894" href="Effect.Handle.html#2894" class="Bound">σ</a> <a id="2896" class="Symbol">=</a> <a id="2898" href="Effect.Syntax.Free.html#4066" class="Function">hmap-natural</a> <a id="2911" class="Symbol">(</a><a id="2912" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1070" class="Function">proj</a> <a id="2917" href="Effect.Handle.html#2894" class="Bound">σ</a><a id="2918" class="Symbol">)</a> <a id="2920" class="Symbol">(</a><a id="2921" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1194" class="Function">proj-natural</a> <a id="2934" href="Effect.Handle.html#2894" class="Bound">σ</a><a id="2935" class="Symbol">)</a> 

  <a id="2941" href="Effect.Handle.html#2941" class="Function">reorder-mm</a> <a id="2952" class="Symbol">:</a> <a id="2954" class="Symbol">(</a><a id="2955" href="Effect.Handle.html#2955" class="Bound">σ</a> <a id="2957" class="Symbol">:</a> <a id="2959" href="Effect.Base.html#921" class="Generalizable">ε₁</a> <a id="2962" href="Core.Ternary.html#767" class="Field Operator">∙</a> <a id="2964" href="Effect.Base.html#924" class="Generalizable">ε₂</a> <a id="2967" href="Core.Ternary.html#767" class="Field Operator">≈</a> <a id="2969" href="Effect.Base.html#919" class="Generalizable">ε</a><a id="2970" class="Symbol">)</a> <a id="2972" class="Symbol">→</a> <a id="2974" href="Core.Functor.Monad.html#1494" class="Record">MonadMorphism</a> <a id="2988" class="Symbol">(</a><a id="2989" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="2994" href="Effect.Base.html#919" class="Generalizable">ε</a><a id="2995" class="Symbol">)</a> <a id="2997" class="Symbol">(</a><a id="2998" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="3003" class="Symbol">(</a><a id="3004" href="Effect.Base.html#921" class="Generalizable">ε₁</a> <a id="3007" href="Core.Container.html#942" class="Function Operator">⊕ᶜ</a> <a id="3010" href="Effect.Base.html#924" class="Generalizable">ε₂</a><a id="3012" class="Symbol">))</a>
  <a id="3017" href="Effect.Handle.html#2941" class="Function">reorder-mm</a> <a id="3028" href="Effect.Handle.html#3028" class="Bound">σ</a> <a id="3030" class="Symbol">=</a> <a id="3032" class="Keyword">record</a>
    <a id="3043" class="Symbol">{</a> <a id="3045" href="Core.Functor.Monad.html#1587" class="Field">Ψ</a>         <a id="3055" class="Symbol">=</a> <a id="3057" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="3065" href="Effect.Handle.html#3028" class="Bound">σ</a>
    <a id="3071" class="Symbol">;</a> <a id="3073" href="Core.Functor.Monad.html#1614" class="Field">Ψ-natural</a> <a id="3083" class="Symbol">=</a> <a id="3085" href="Effect.Handle.html#2818" class="Function">reorder-natural</a> <a id="3101" href="Effect.Handle.html#3028" class="Bound">σ</a>
    <a id="3107" class="Symbol">;</a> <a id="3109" href="Core.Functor.Monad.html#1698" class="Field">resp-unit</a> <a id="3119" class="Symbol">=</a> <a id="3121" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
    <a id="3130" class="Symbol">;</a> <a id="3132" href="Core.Functor.Monad.html#1850" class="Field">resp-join</a> <a id="3142" class="Symbol">=</a> <a id="3144" class="Symbol">λ</a> <a id="3146" href="Effect.Handle.html#3146" class="Bound">k₁</a> <a id="3149" href="Effect.Handle.html#3149" class="Bound">k₂</a> <a id="3152" class="Symbol">→</a> <a id="3154" href="Core.Extensionality.html#201" class="Function">extensionality</a> <a id="3169" class="Symbol">λ</a> <a id="3171" href="Effect.Handle.html#3171" class="Bound">x</a> <a id="3173" class="Symbol">→</a> <a id="3175" href="Effect.Handle.html#1844" class="Function">reorder-coherent</a> <a id="3192" class="Symbol">(</a><a id="3193" href="Effect.Handle.html#3146" class="Bound">k₁</a> <a id="3196" href="Effect.Handle.html#3171" class="Bound">x</a><a id="3197" class="Symbol">)</a> <a id="3199" href="Effect.Handle.html#3149" class="Bound">k₂</a> <a id="3202" href="Effect.Handle.html#3028" class="Bound">σ</a>
    <a id="3208" class="Symbol">}</a>

<a id="weaken-lemma"></a><a id="3211" href="Effect.Handle.html#3211" class="Function">weaken-lemma</a> <a id="3224" class="Symbol">:</a> <a id="3226" class="Symbol">(</a><a id="3227" href="Effect.Handle.html#3227" class="Bound">σ</a> <a id="3229" class="Symbol">:</a> <a id="3231" href="Effect.Base.html#921" class="Generalizable">ε₁</a> <a id="3234" href="Core.Ternary.html#767" class="Field Operator">∙</a> <a id="3236" href="Effect.Base.html#924" class="Generalizable">ε₂</a> <a id="3239" href="Core.Ternary.html#767" class="Field Operator">≈</a> <a id="3241" href="Effect.Base.html#919" class="Generalizable">ε</a><a id="3242" class="Symbol">)</a> <a id="3244" class="Symbol">→</a> <a id="3246" class="Symbol">(</a><a id="3247" href="Effect.Handle.html#3247" class="Bound">m</a> <a id="3249" class="Symbol">:</a> <a id="3251" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="3256" href="Effect.Base.html#924" class="Generalizable">ε₂</a> <a id="3259" href="Core.Functor.html#1514" class="Generalizable">A</a><a id="3260" class="Symbol">)</a> <a id="3262" class="Symbol">→</a> <a id="3264" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="3272" href="Effect.Handle.html#3227" class="Bound">σ</a> <a id="3274" class="Symbol">(</a><a id="3275" href="Effect.Relation.Binary.FirstOrderInclusion.html#2308" class="Function">♯ʳ′</a> <a id="3279" href="Effect.Handle.html#3227" class="Bound">σ</a> <a id="3281" href="Effect.Handle.html#3247" class="Bound">m</a><a id="3282" class="Symbol">)</a> <a id="3284" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="3286" href="Effect.Relation.Binary.FirstOrderInclusion.html#2154" class="Function">♯ʳ</a> <a id="3289" href="Effect.Base.html#921" class="Generalizable">ε₁</a> <a id="3292" href="Effect.Handle.html#3247" class="Bound">m</a>
<a id="3294" href="Effect.Handle.html#3211" class="Function">weaken-lemma</a>               <a id="3321" href="Effect.Handle.html#3321" class="Bound">σ</a> <a id="3323" class="Symbol">(</a><a id="3324" href="Effect.Syntax.Free.html#529" class="InductiveConstructor">pure</a> <a id="3329" class="Symbol">_)</a>           <a id="3342" class="Symbol">=</a> <a id="3344" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="3349" href="Effect.Handle.html#3211" class="Function">weaken-lemma</a> <a id="3362" class="Symbol">{</a><a id="3363" href="Effect.Handle.html#3363" class="Bound">ε₁</a><a id="3365" class="Symbol">}</a> <a id="3367" class="Symbol">{</a><a id="3368" href="Effect.Handle.html#3368" class="Bound">ε₂</a><a id="3370" class="Symbol">}</a> <a id="3372" class="Symbol">{</a><a id="3373" href="Effect.Handle.html#3373" class="Bound">ε</a><a id="3374" class="Symbol">}</a> <a id="3376" href="Effect.Handle.html#3376" class="Bound">σ</a> <a id="3378" class="Symbol">(</a><a id="3379" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="3386" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="3388" href="Effect.Handle.html#3388" class="Bound">c</a> <a id="3390" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3392" href="Effect.Handle.html#3392" class="Bound">r</a> <a id="3394" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="3395" class="Symbol">)</a> <a id="3397" class="Symbol">=</a>
  <a id="3401" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
    <a id="3411" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="3419" href="Effect.Handle.html#3376" class="Bound">σ</a> <a id="3421" class="Symbol">(</a><a id="3422" href="Effect.Relation.Binary.FirstOrderInclusion.html#2308" class="Function">♯ʳ′</a> <a id="3426" href="Effect.Handle.html#3376" class="Bound">σ</a> <a id="3428" class="Symbol">(</a><a id="3429" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="3436" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="3438" href="Effect.Handle.html#3388" class="Bound">c</a> <a id="3440" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3442" href="Effect.Handle.html#3392" class="Bound">r</a> <a id="3444" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="3445" class="Symbol">))</a>
  <a id="3450" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a> 
    <a id="3459" href="Effect.Syntax.Free.html#1715" class="Function">hmap-free</a> <a id="3469" class="Symbol">(</a><a id="3470" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1070" class="Function">proj</a> <a id="3475" href="Effect.Handle.html#3376" class="Bound">σ</a><a id="3476" class="Symbol">)</a> <a id="3478" class="Symbol">(</a><a id="3479" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="3486" class="Symbol">(</a><a id="3487" href="Effect.Relation.Ternary.FirstOrderSeparation.html#843" class="Function">injb</a> <a id="3492" href="Effect.Handle.html#3376" class="Bound">σ</a> <a id="3494" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="3496" href="Effect.Handle.html#3388" class="Bound">c</a> <a id="3498" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3500" href="Effect.Relation.Binary.FirstOrderInclusion.html#2308" class="Function">♯ʳ′</a> <a id="3504" href="Effect.Handle.html#3376" class="Bound">σ</a> <a id="3506" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3508" href="Effect.Handle.html#3392" class="Bound">r</a> <a id="3510" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="3511" class="Symbol">)</a> <a id="3513" class="Symbol">)</a>
  <a id="3517" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a> 
    <a id="3526" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="3533" class="Symbol">(</a><a id="3534" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1070" class="Function">proj</a> <a id="3539" href="Effect.Handle.html#3376" class="Bound">σ</a> <a id="3541" class="Symbol">(</a><a id="3542" href="Core.Functor.html#495" class="Field">fmap</a> <a id="3547" class="Symbol">(</a><a id="3548" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="3556" href="Effect.Handle.html#3376" class="Bound">σ</a><a id="3557" class="Symbol">)</a> <a id="3559" class="Symbol">(</a><a id="3560" href="Effect.Relation.Ternary.FirstOrderSeparation.html#843" class="Function">injb</a> <a id="3565" href="Effect.Handle.html#3376" class="Bound">σ</a> <a id="3567" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="3569" href="Effect.Handle.html#3388" class="Bound">c</a> <a id="3571" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3573" href="Effect.Relation.Binary.FirstOrderInclusion.html#2308" class="Function">♯ʳ′</a> <a id="3577" href="Effect.Handle.html#3376" class="Bound">σ</a> <a id="3579" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3581" href="Effect.Handle.html#3392" class="Bound">r</a> <a id="3583" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="3584" class="Symbol">)))</a> 
  <a id="3591" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="3594" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="3599" class="Symbol">(</a><a id="3600" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="3607" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3609" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1070" class="Function">proj</a> <a id="3614" href="Effect.Handle.html#3376" class="Bound">σ</a><a id="3615" class="Symbol">)</a> <a id="3617" class="Symbol">(</a><a id="3618" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">sym</a> <a id="3622" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="3624" href="Effect.Relation.Ternary.FirstOrderSeparation.html#904" class="Function">injb-natural</a> <a id="3637" href="Effect.Handle.html#3376" class="Bound">σ</a> <a id="3639" class="Symbol">.</a><a id="3640" href="Core.Functor.NaturalTransformation.html#590" class="Field">commute</a> <a id="3648" class="Symbol">{</a><a id="3649" class="Argument">f</a> <a id="3651" class="Symbol">=</a> <a id="3653" href="Core.Functor.html#495" class="Field">fmap</a> <a id="3658" class="Symbol">(</a><a id="3659" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="3667" href="Effect.Handle.html#3376" class="Bound">σ</a><a id="3668" class="Symbol">)}</a> <a id="3671" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="3673" href="Effect.Handle.html#3388" class="Bound">c</a> <a id="3675" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3677" href="Effect.Relation.Binary.FirstOrderInclusion.html#2308" class="Function">♯ʳ′</a> <a id="3681" href="Effect.Handle.html#3376" class="Bound">σ</a> <a id="3683" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3685" href="Effect.Handle.html#3392" class="Bound">r</a> <a id="3687" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="3688" class="Symbol">)</a>  <a id="3691" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a>
    <a id="3697" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="3704" class="Symbol">(</a><a id="3705" href="Effect.Relation.Ternary.FirstOrderSeparation.html#1070" class="Function">proj</a> <a id="3710" href="Effect.Handle.html#3376" class="Bound">σ</a> <a id="3712" class="Symbol">(</a><a id="3713" href="Effect.Relation.Ternary.FirstOrderSeparation.html#843" class="Function">injb</a> <a id="3718" href="Effect.Handle.html#3376" class="Bound">σ</a> <a id="3720" class="Symbol">(</a><a id="3721" href="Core.Functor.html#495" class="Field">fmap</a> <a id="3726" class="Symbol">(</a><a id="3727" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="3735" href="Effect.Handle.html#3376" class="Bound">σ</a><a id="3736" class="Symbol">)</a> <a id="3738" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="3740" href="Effect.Handle.html#3388" class="Bound">c</a> <a id="3742" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3744" href="Effect.Relation.Binary.FirstOrderInclusion.html#2308" class="Function">♯ʳ′</a> <a id="3748" href="Effect.Handle.html#3376" class="Bound">σ</a> <a id="3750" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3752" href="Effect.Handle.html#3392" class="Bound">r</a> <a id="3754" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="3755" class="Symbol">)))</a> 
  <a id="3762" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="3765" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="3770" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="3777" class="Symbol">(</a><a id="3778" href="Effect.Handle.html#3376" class="Bound">σ</a> <a id="3780" class="Symbol">.</a><a id="3781" href="Effect.Relation.Ternary.FirstOrderSeparation.html#570" class="Field">union</a> <a id="3787" class="Symbol">.</a><a id="3788" href="Core.Container.html#1779" class="Field">equivalence</a> <a id="3800" class="Symbol">_</a> <a id="3802" class="Symbol">.</a><a id="3803" href="Function.Bundles.html#7526" class="Field">inverse</a> <a id="3811" class="Symbol">.</a><a id="3812" href="Data.Product.Base.html#650" class="Field">proj₂</a> <a id="3818" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="3822" class="Symbol">)</a> <a id="3824" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a> 
    <a id="3831" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="3838" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="3840" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="3845" href="Effect.Handle.html#3388" class="Bound">c</a> <a id="3847" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3849" class="Symbol">(</a><a id="3850" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="3858" href="Effect.Handle.html#3376" class="Bound">σ</a> <a id="3860" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3862" href="Effect.Relation.Binary.FirstOrderInclusion.html#2308" class="Function">♯ʳ′</a> <a id="3866" href="Effect.Handle.html#3376" class="Bound">σ</a><a id="3867" class="Symbol">)</a> <a id="3869" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3871" href="Effect.Handle.html#3392" class="Bound">r</a> <a id="3873" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a> 
  <a id="3878" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="3881" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="3886" class="Symbol">(λ</a> <a id="3889" href="Effect.Handle.html#3889" class="Bound">○</a> <a id="3891" class="Symbol">→</a> <a id="3893" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="3900" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="3902" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="3907" href="Effect.Handle.html#3388" class="Bound">c</a> <a id="3909" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3911" href="Effect.Handle.html#3889" class="Bound">○</a> <a id="3913" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="3914" class="Symbol">)</a> <a id="3916" class="Symbol">(</a><a id="3917" href="Core.Extensionality.html#201" class="Function">extensionality</a> <a id="3932" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="3934" href="Effect.Handle.html#3211" class="Function">weaken-lemma</a> <a id="3947" href="Effect.Handle.html#3376" class="Bound">σ</a> <a id="3949" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3951" href="Effect.Handle.html#3392" class="Bound">r</a><a id="3952" class="Symbol">)</a> <a id="3954" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a>
    <a id="3960" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="3967" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="3969" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="3974" href="Effect.Handle.html#3388" class="Bound">c</a> <a id="3976" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="3978" href="Effect.Relation.Binary.FirstOrderInclusion.html#2154" class="Function">♯ʳ</a> <a id="3981" href="Effect.Handle.html#3363" class="Bound">ε₁</a> <a id="3984" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="3986" href="Effect.Handle.html#3392" class="Bound">r</a> <a id="3988" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a> 
  <a id="3993" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a> <a id="3997" class="Comment">{- Definition of ♯ʳ -}</a>  
    <a id="4026" href="Effect.Relation.Binary.FirstOrderInclusion.html#2154" class="Function">♯ʳ</a> <a id="4029" href="Effect.Handle.html#3363" class="Bound">ε₁</a> <a id="4032" class="Symbol">(</a><a id="4033" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="4040" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="4042" href="Effect.Handle.html#3388" class="Bound">c</a> <a id="4044" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4046" href="Effect.Handle.html#3392" class="Bound">r</a> <a id="4048" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="4049" class="Symbol">)</a>
  <a id="4053" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
  <a id="4057" class="Keyword">where</a> <a id="4063" class="Keyword">open</a> <a id="4068" href="Relation.Binary.PropositionalEquality.Properties.html#6744" class="Module">≡-Reasoning</a>


<a id="4082" class="Comment">-- Handers of an effect are algebras over its signatures</a>
<a id="4139" class="Keyword">record</a> <a id="Handler"></a><a id="4146" href="Effect.Handle.html#4146" class="Record">Handler</a> <a id="4154" class="Symbol">(</a><a id="4155" href="Effect.Handle.html#4155" class="Bound">ε</a> <a id="4157" class="Symbol">:</a> <a id="4159" href="Effect.Base.html#735" class="Function">Effect</a><a id="4165" class="Symbol">)</a> <a id="4167" class="Symbol">(</a><a id="4168" href="Effect.Handle.html#4168" class="Bound">P</a> <a id="4170" class="Symbol">:</a> <a id="4172" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="4175" class="Symbol">)</a> <a id="4177" class="Symbol">(</a><a id="4178" href="Effect.Handle.html#4178" class="Bound">F</a> <a id="4180" class="Symbol">:</a> <a id="4182" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="4186" class="Symbol">→</a> <a id="4188" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="4191" class="Symbol">)</a> <a id="4193" class="Symbol">:</a> <a id="4195" href="Agda.Primitive.html#388" class="Primitive">Set₁</a> <a id="4200" class="Keyword">where</a>

  <a id="Handler.M"></a><a id="4209" href="Effect.Handle.html#4209" class="Function">M</a> <a id="4211" class="Symbol">:</a> <a id="4213" href="Effect.Base.html#735" class="Function">Effect</a> <a id="4220" class="Symbol">→</a> <a id="4222" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="4226" class="Symbol">→</a> <a id="4228" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="4234" href="Effect.Handle.html#4209" class="Function">M</a> <a id="4236" href="Effect.Handle.html#4236" class="Bound">ε</a> <a id="4238" href="Effect.Handle.html#4238" class="Bound">A</a> <a id="4240" class="Symbol">=</a> <a id="4242" href="Effect.Handle.html#4168" class="Bound">P</a> <a id="4244" class="Symbol">→</a> <a id="4246" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="4251" href="Effect.Handle.html#4236" class="Bound">ε</a> <a id="4253" class="Symbol">(</a><a id="4254" href="Effect.Handle.html#4178" class="Bound">F</a> <a id="4256" href="Effect.Handle.html#4238" class="Bound">A</a><a id="4257" class="Symbol">)</a> 
  
  <a id="4265" class="Keyword">field</a>
    <a id="4275" class="Symbol">{{</a> <a id="Handler.F-functor"></a><a id="4278" href="Effect.Handle.html#4278" class="Field">F-functor</a> <a id="4288" class="Symbol">}}</a> <a id="4291" class="Symbol">:</a> <a id="4293" href="Core.Functor.html#424" class="Record">Functor</a> <a id="4301" href="Effect.Handle.html#4178" class="Bound">F</a>
    <a id="4307" class="Symbol">{{</a> <a id="Handler.M-monad"></a><a id="4310" href="Effect.Handle.html#4310" class="Field">M-monad</a>   <a id="4320" class="Symbol">}}</a> <a id="4323" class="Symbol">:</a> <a id="4325" href="Relation.Unary.html#3629" class="Function">∀[</a> <a id="4328" href="Effect.Handle.html#4209" class="Function">M</a> <a id="4330" href="Relation.Unary.html#5366" class="Function Operator">⊢</a> <a id="4332" href="Core.Functor.Monad.html#268" class="Record">Monad</a> <a id="4338" href="Relation.Unary.html#3629" class="Function">]</a>

    <a id="Handler.hdl"></a><a id="4345" href="Effect.Handle.html#4345" class="Field">hdl</a>         <a id="4357" class="Symbol">:</a> <a id="4359" class="Symbol">∀</a> <a id="4361" class="Symbol">{</a><a id="4362" href="Effect.Handle.html#4362" class="Bound">ε′</a><a id="4364" class="Symbol">}</a> <a id="4366" class="Symbol">→</a> <a id="4368" href="Core.Container.html#803" class="Record">Algebraᶜ</a> <a id="4377" href="Effect.Handle.html#4155" class="Bound">ε</a> <a id="4379" class="Symbol">(</a><a id="4380" href="Effect.Handle.html#4209" class="Function">M</a> <a id="4382" href="Effect.Handle.html#4362" class="Bound">ε′</a> <a id="4385" href="Core.Functor.html#1514" class="Generalizable">A</a><a id="4386" class="Symbol">)</a> 

  <a id="4392" class="Keyword">instance</a> <a id="Handler.M-functor"></a><a id="4401" href="Effect.Handle.html#4401" class="Function">M-functor</a> <a id="4411" class="Symbol">:</a> <a id="4413" href="Relation.Unary.html#3629" class="Function">∀[</a> <a id="4416" href="Effect.Handle.html#4209" class="Function">M</a> <a id="4418" href="Relation.Unary.html#5366" class="Function Operator">⊢</a> <a id="4420" href="Core.Functor.html#424" class="Record">Functor</a> <a id="4428" href="Relation.Unary.html#3629" class="Function">]</a>
  <a id="4432" href="Effect.Handle.html#4401" class="Function">M-functor</a> <a id="4442" class="Symbol">=</a> <a id="4444" href="Core.Functor.Monad.html#1158" class="Function">is-functor</a> 

  <a id="4459" class="Keyword">field</a>
    <a id="Handler.M-apply"></a><a id="4469" href="Effect.Handle.html#4469" class="Field">M-apply</a> <a id="4477" class="Symbol">:</a>
      <a id="4485" class="Symbol">∀</a> <a id="4487" class="Symbol">{</a><a id="4488" href="Effect.Handle.html#4488" class="Bound">X</a> <a id="4490" href="Effect.Handle.html#4490" class="Bound">Y</a><a id="4491" class="Symbol">}</a> <a id="4493" class="Symbol">{</a><a id="4494" href="Effect.Handle.html#4494" class="Bound">f</a> <a id="4496" class="Symbol">:</a> <a id="4498" href="Effect.Handle.html#4488" class="Bound">X</a> <a id="4500" class="Symbol">→</a> <a id="4502" href="Effect.Handle.html#4490" class="Bound">Y</a><a id="4503" class="Symbol">}</a> <a id="4505" class="Symbol">{</a><a id="4506" href="Effect.Handle.html#4506" class="Bound">g</a> <a id="4508" class="Symbol">:</a> <a id="4510" href="Effect.Handle.html#4209" class="Function">M</a> <a id="4512" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="4515" href="Effect.Handle.html#4488" class="Bound">X</a><a id="4516" class="Symbol">}</a> <a id="4518" class="Symbol">{</a><a id="4519" href="Effect.Handle.html#4519" class="Bound">p</a> <a id="4521" class="Symbol">:</a> <a id="4523" href="Effect.Handle.html#4168" class="Bound">P</a><a id="4524" class="Symbol">}</a>
        <a id="4534" class="Comment">---------------------------------------------------------</a>
      <a id="4598" class="Symbol">→</a> <a id="4600" href="Core.Functor.html#495" class="Field">fmap</a> <a id="4605" class="Symbol">{</a><a id="4606" class="Argument">F</a> <a id="4608" class="Symbol">=</a> <a id="4610" href="Effect.Handle.html#4209" class="Function">M</a> <a id="4612" class="Symbol">_}</a> <a id="4615" href="Effect.Handle.html#4494" class="Bound">f</a> <a id="4617" href="Effect.Handle.html#4506" class="Bound">g</a> <a id="4619" href="Effect.Handle.html#4519" class="Bound">p</a> <a id="4621" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="4623" class="Symbol">(</a><a id="4624" href="Core.Functor.html#495" class="Field">fmap</a> <a id="4629" class="Symbol">{</a><a id="4630" class="Argument">F</a> <a id="4632" class="Symbol">=</a> <a id="4634" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="4639" class="Symbol">_}</a> <a id="4642" class="Symbol">(</a><a id="4643" href="Core.Functor.html#495" class="Field">fmap</a> <a id="4648" href="Effect.Handle.html#4494" class="Bound">f</a><a id="4649" class="Symbol">)</a> <a id="4651" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="4653" href="Effect.Handle.html#4506" class="Bound">g</a><a id="4654" class="Symbol">)</a> <a id="4656" href="Effect.Handle.html#4519" class="Bound">p</a> 

    <a id="Handler.hdl-commute"></a><a id="4664" href="Effect.Handle.html#4664" class="Field">hdl-commute</a> <a id="4676" class="Symbol">:</a>
      <a id="4684" class="Symbol">∀</a> <a id="4686" class="Symbol">{</a><a id="4687" href="Effect.Handle.html#4687" class="Bound">X</a> <a id="4689" href="Effect.Handle.html#4689" class="Bound">Y</a> <a id="4691" class="Symbol">:</a> <a id="4693" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="4696" class="Symbol">}</a> <a id="4698" class="Symbol">(</a><a id="4699" href="Effect.Handle.html#4699" class="Bound">f</a> <a id="4701" class="Symbol">:</a> <a id="4703" href="Effect.Handle.html#4687" class="Bound">X</a> <a id="4705" class="Symbol">→</a> <a id="4707" href="Effect.Handle.html#4689" class="Bound">Y</a><a id="4708" class="Symbol">)</a> <a id="4710" class="Symbol">(</a><a id="4711" href="Effect.Handle.html#4711" class="Bound">x</a> <a id="4713" class="Symbol">:</a> <a id="4715" href="Core.Container.html#676" class="Record Operator">⟦</a> <a id="4717" href="Effect.Handle.html#4155" class="Bound">ε</a> <a id="4719" href="Core.Container.html#676" class="Record Operator">⟧ᶜ</a> <a id="4722" class="Symbol">(</a><a id="4723" href="Effect.Handle.html#4209" class="Function">M</a> <a id="4725" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="4728" href="Effect.Handle.html#4687" class="Bound">X</a><a id="4729" class="Symbol">))</a>
        <a id="4740" class="Comment">-----------------------------------------------------------</a>
      <a id="4806" class="Symbol">→</a> <a id="4808" href="Effect.Handle.html#4345" class="Field">hdl</a> <a id="4812" class="Symbol">.</a><a id="4813" href="Core.Container.html#844" class="Field">αᶜ</a> <a id="4816" class="Symbol">(</a><a id="4817" href="Core.Functor.html#495" class="Field">fmap</a> <a id="4822" class="Symbol">{</a><a id="4823" class="Argument">F</a> <a id="4825" class="Symbol">=</a> <a id="4827" href="Core.Container.html#676" class="Record Operator">⟦</a> <a id="4829" class="Symbol">_</a> <a id="4831" href="Core.Container.html#676" class="Record Operator">⟧ᶜ</a><a id="4833" class="Symbol">}</a> <a id="4835" class="Symbol">(</a><a id="4836" href="Core.Functor.html#495" class="Field">fmap</a> <a id="4841" href="Effect.Handle.html#4699" class="Bound">f</a><a id="4842" class="Symbol">)</a> <a id="4844" href="Effect.Handle.html#4711" class="Bound">x</a><a id="4845" class="Symbol">)</a> <a id="4847" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="4849" href="Core.Functor.html#495" class="Field">fmap</a> <a id="4854" href="Effect.Handle.html#4699" class="Bound">f</a> <a id="4856" class="Symbol">(</a><a id="4857" href="Effect.Handle.html#4345" class="Field">hdl</a> <a id="4861" class="Symbol">.</a><a id="4862" href="Core.Container.html#844" class="Field">αᶜ</a> <a id="4865" href="Effect.Handle.html#4711" class="Bound">x</a><a id="4866" class="Symbol">)</a> 


  <a id="Handler.fwd"></a><a id="4873" href="Effect.Handle.html#4873" class="Function">fwd</a> <a id="4877" class="Symbol">:</a> <a id="4879" href="Core.Container.html#803" class="Record">Algebraᶜ</a> <a id="4888" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="4891" class="Symbol">(</a><a id="4892" href="Effect.Handle.html#4209" class="Function">M</a> <a id="4894" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="4897" href="Core.Functor.html#1514" class="Generalizable">A</a><a id="4898" class="Symbol">)</a>
  <a id="4902" href="Effect.Handle.html#4873" class="Function">fwd</a> <a id="4906" class="Symbol">.</a><a id="4907" href="Core.Container.html#844" class="Field">αᶜ</a> <a id="4910" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="4912" href="Effect.Handle.html#4912" class="Bound">c</a> <a id="4914" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4916" href="Effect.Handle.html#4916" class="Bound">k</a> <a id="4918" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a> <a id="4920" class="Symbol">=</a> <a id="4922" class="Symbol">(λ</a> <a id="4925" href="Effect.Handle.html#4925" class="Bound">p</a> <a id="4927" class="Symbol">→</a> <a id="4929" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="4936" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="4938" href="Effect.Handle.html#4912" class="Bound">c</a> <a id="4940" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="4942" href="Function.Base.html#1638" class="Function">flip</a> <a id="4947" href="Effect.Handle.html#4916" class="Bound">k</a> <a id="4949" href="Effect.Handle.html#4925" class="Bound">p</a> <a id="4951" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="4952" class="Symbol">)</a> 


  <a id="Handler.fwd-commute"></a><a id="4959" href="Effect.Handle.html#4959" class="Function">fwd-commute</a> <a id="4971" class="Symbol">:</a>
     <a id="4978" class="Symbol">∀</a> <a id="4980" class="Symbol">{</a><a id="4981" href="Effect.Handle.html#4981" class="Bound">X</a> <a id="4983" href="Effect.Handle.html#4983" class="Bound">Y</a> <a id="4985" class="Symbol">:</a> <a id="4987" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="4990" class="Symbol">}</a> <a id="4992" class="Symbol">(</a><a id="4993" href="Effect.Handle.html#4993" class="Bound">f</a> <a id="4995" class="Symbol">:</a> <a id="4997" href="Effect.Handle.html#4981" class="Bound">X</a> <a id="4999" class="Symbol">→</a> <a id="5001" href="Effect.Handle.html#4983" class="Bound">Y</a><a id="5002" class="Symbol">)</a> <a id="5004" class="Symbol">(</a><a id="5005" href="Effect.Handle.html#5005" class="Bound">x</a> <a id="5007" class="Symbol">:</a> <a id="5009" href="Core.Container.html#676" class="Record Operator">⟦</a> <a id="5011" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="5014" href="Core.Container.html#676" class="Record Operator">⟧ᶜ</a> <a id="5017" class="Symbol">(</a><a id="5018" href="Effect.Handle.html#4209" class="Function">M</a> <a id="5020" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="5023" href="Effect.Handle.html#4981" class="Bound">X</a><a id="5024" class="Symbol">))</a>
      <a id="5033" class="Comment">-----------------------------------------------------------</a>
    <a id="5097" class="Symbol">→</a> <a id="5099" href="Effect.Handle.html#4873" class="Function">fwd</a> <a id="5103" class="Symbol">.</a><a id="5104" href="Core.Container.html#844" class="Field">αᶜ</a> <a id="5107" class="Symbol">(</a><a id="5108" href="Core.Functor.html#495" class="Field">fmap</a> <a id="5113" class="Symbol">{</a><a id="5114" class="Argument">F</a> <a id="5116" class="Symbol">=</a> <a id="5118" href="Core.Container.html#676" class="Record Operator">⟦</a> <a id="5120" class="Symbol">_</a> <a id="5122" href="Core.Container.html#676" class="Record Operator">⟧ᶜ</a><a id="5124" class="Symbol">}</a> <a id="5126" class="Symbol">(</a><a id="5127" href="Core.Functor.html#495" class="Field">fmap</a> <a id="5132" href="Effect.Handle.html#4993" class="Bound">f</a><a id="5133" class="Symbol">)</a> <a id="5135" href="Effect.Handle.html#5005" class="Bound">x</a><a id="5136" class="Symbol">)</a> <a id="5138" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5140" href="Core.Functor.html#495" class="Field">fmap</a> <a id="5145" href="Effect.Handle.html#4993" class="Bound">f</a> <a id="5147" class="Symbol">(</a><a id="5148" href="Effect.Handle.html#4873" class="Function">fwd</a> <a id="5152" class="Symbol">.</a><a id="5153" href="Core.Container.html#844" class="Field">αᶜ</a> <a id="5156" href="Effect.Handle.html#5005" class="Bound">x</a><a id="5157" class="Symbol">)</a>
  <a id="5161" href="Effect.Handle.html#4959" class="Function">fwd-commute</a> <a id="5173" href="Effect.Handle.html#5173" class="Bound">f</a> <a id="5175" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="5177" href="Effect.Handle.html#5177" class="Bound">c</a> <a id="5179" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5181" href="Effect.Handle.html#5181" class="Bound">k</a> <a id="5183" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a> <a id="5185" class="Symbol">=</a> <a id="5187" href="Core.Extensionality.html#201" class="Function">extensionality</a> <a id="5202" class="Symbol">λ</a> <a id="5204" href="Effect.Handle.html#5204" class="Bound">p</a> <a id="5206" class="Symbol">→</a>
    <a id="5212" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
      <a id="5224" href="Effect.Handle.html#4873" class="Function">fwd</a> <a id="5228" class="Symbol">.</a><a id="5229" href="Core.Container.html#844" class="Field">αᶜ</a> <a id="5232" class="Symbol">(</a><a id="5233" href="Core.Functor.html#495" class="Field">fmap</a> <a id="5238" class="Symbol">{</a><a id="5239" class="Argument">F</a> <a id="5241" class="Symbol">=</a> <a id="5243" href="Core.Container.html#676" class="Record Operator">⟦</a> <a id="5245" class="Symbol">_</a> <a id="5247" href="Core.Container.html#676" class="Record Operator">⟧ᶜ</a><a id="5249" class="Symbol">}</a> <a id="5251" class="Symbol">(</a><a id="5252" href="Core.Functor.html#495" class="Field">fmap</a> <a id="5257" href="Effect.Handle.html#5173" class="Bound">f</a><a id="5258" class="Symbol">)</a> <a id="5260" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="5262" href="Effect.Handle.html#5177" class="Bound">c</a> <a id="5264" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5266" href="Effect.Handle.html#5181" class="Bound">k</a> <a id="5268" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="5269" class="Symbol">)</a> <a id="5271" href="Effect.Handle.html#5204" class="Bound">p</a>
    <a id="5277" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a> 
      <a id="5288" href="Effect.Handle.html#4873" class="Function">fwd</a> <a id="5292" class="Symbol">.</a><a id="5293" href="Core.Container.html#844" class="Field">αᶜ</a> <a id="5296" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="5298" class="Symbol">(</a><a id="5299" href="Effect.Handle.html#5177" class="Bound">c</a> <a id="5301" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5303" href="Core.Functor.html#495" class="Field">fmap</a> <a id="5308" href="Effect.Handle.html#5173" class="Bound">f</a> <a id="5310" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="5312" href="Effect.Handle.html#5181" class="Bound">k</a><a id="5313" class="Symbol">)</a> <a id="5315" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a> <a id="5317" href="Effect.Handle.html#5204" class="Bound">p</a>
    <a id="5323" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a> 
      <a id="5334" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="5341" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="5343" href="Effect.Handle.html#5177" class="Bound">c</a> <a id="5345" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5347" class="Symbol">(λ</a> <a id="5350" href="Effect.Handle.html#5350" class="Bound">x</a> <a id="5352" class="Symbol">→</a> <a id="5354" href="Core.Functor.html#495" class="Field">fmap</a> <a id="5359" href="Effect.Handle.html#5173" class="Bound">f</a> <a id="5361" class="Symbol">(</a><a id="5362" href="Effect.Handle.html#5181" class="Bound">k</a> <a id="5364" href="Effect.Handle.html#5350" class="Bound">x</a><a id="5365" class="Symbol">)</a> <a id="5367" href="Effect.Handle.html#5204" class="Bound">p</a><a id="5368" class="Symbol">)</a> <a id="5370" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a>
    <a id="5376" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="5379" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="5384" class="Symbol">(λ</a> <a id="5387" href="Effect.Handle.html#5387" class="Bound">○</a> <a id="5389" class="Symbol">→</a> <a id="5391" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="5398" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="5400" href="Effect.Handle.html#5177" class="Bound">c</a> <a id="5402" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5404" href="Effect.Handle.html#5387" class="Bound">○</a> <a id="5406" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="5407" class="Symbol">)</a> <a id="5409" class="Symbol">(</a><a id="5410" href="Core.Extensionality.html#201" class="Function">extensionality</a> <a id="5425" class="Symbol">λ</a> <a id="5427" href="Effect.Handle.html#5427" class="Bound">_</a> <a id="5429" class="Symbol">→</a> <a id="5431" href="Effect.Handle.html#4469" class="Field">M-apply</a><a id="5438" class="Symbol">)</a> <a id="5440" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a> 
      <a id="5449" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="5456" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="5458" href="Effect.Handle.html#5177" class="Bound">c</a> <a id="5460" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5462" class="Symbol">(λ</a> <a id="5465" href="Effect.Handle.html#5465" class="Bound">x</a> <a id="5467" class="Symbol">→</a> <a id="5469" href="Core.Functor.html#495" class="Field">fmap</a> <a id="5474" class="Symbol">{</a><a id="5475" class="Argument">F</a> <a id="5477" class="Symbol">=</a> <a id="5479" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="5484" class="Symbol">_}</a> <a id="5487" class="Symbol">(</a><a id="5488" href="Core.Functor.html#495" class="Field">fmap</a> <a id="5493" href="Effect.Handle.html#5173" class="Bound">f</a><a id="5494" class="Symbol">)</a> <a id="5496" class="Symbol">(</a><a id="5497" href="Effect.Handle.html#5181" class="Bound">k</a> <a id="5499" href="Effect.Handle.html#5465" class="Bound">x</a> <a id="5501" href="Effect.Handle.html#5204" class="Bound">p</a><a id="5502" class="Symbol">))</a> <a id="5505" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a> 
    <a id="5512" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="5515" href="Relation.Binary.PropositionalEquality.Core.html#1712" class="Function">sym</a> <a id="5519" href="Effect.Handle.html#4469" class="Field">M-apply</a> <a id="5527" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a>
      <a id="5535" href="Core.Functor.html#495" class="Field">fmap</a> <a id="5540" href="Effect.Handle.html#5173" class="Bound">f</a> <a id="5542" class="Symbol">(λ</a> <a id="5545" href="Effect.Handle.html#5545" class="Bound">p′</a> <a id="5548" class="Symbol">→</a> <a id="5550" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="5557" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="5559" href="Effect.Handle.html#5177" class="Bound">c</a> <a id="5561" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5563" class="Symbol">(λ</a> <a id="5566" href="Effect.Handle.html#5566" class="Bound">x</a> <a id="5568" class="Symbol">→</a> <a id="5570" href="Effect.Handle.html#5181" class="Bound">k</a> <a id="5572" href="Effect.Handle.html#5566" class="Bound">x</a> <a id="5574" href="Effect.Handle.html#5545" class="Bound">p′</a><a id="5576" class="Symbol">)</a> <a id="5578" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="5579" class="Symbol">)</a> <a id="5581" href="Effect.Handle.html#5204" class="Bound">p</a>
    <a id="5587" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a> 
      <a id="5598" href="Core.Functor.html#495" class="Field">fmap</a> <a id="5603" href="Effect.Handle.html#5173" class="Bound">f</a> <a id="5605" class="Symbol">(</a><a id="5606" href="Effect.Handle.html#4873" class="Function">fwd</a> <a id="5610" class="Symbol">.</a><a id="5611" href="Core.Container.html#844" class="Field">αᶜ</a> <a id="5614" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="5616" href="Effect.Handle.html#5177" class="Bound">c</a> <a id="5618" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5620" href="Effect.Handle.html#5181" class="Bound">k</a> <a id="5622" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="5623" class="Symbol">)</a> <a id="5625" href="Effect.Handle.html#5204" class="Bound">p</a>
    <a id="5631" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a> 
    <a id="5638" class="Keyword">where</a> <a id="5644" class="Keyword">open</a> <a id="5649" href="Relation.Binary.PropositionalEquality.Properties.html#6744" class="Module">≡-Reasoning</a>

  <a id="Handler.hdl-alg-commute"></a><a id="5664" href="Effect.Handle.html#5664" class="Function">hdl-alg-commute</a> <a id="5680" class="Symbol">:</a>
    <a id="5686" class="Symbol">∀</a> <a id="5688" class="Symbol">{</a><a id="5689" href="Effect.Handle.html#5689" class="Bound">X</a> <a id="5691" href="Effect.Handle.html#5691" class="Bound">Y</a> <a id="5693" class="Symbol">:</a> <a id="5695" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="5698" class="Symbol">}</a> <a id="5700" class="Symbol">(</a><a id="5701" href="Effect.Handle.html#5701" class="Bound">f</a> <a id="5703" class="Symbol">:</a> <a id="5705" href="Effect.Handle.html#5689" class="Bound">X</a> <a id="5707" class="Symbol">→</a> <a id="5709" href="Effect.Handle.html#5691" class="Bound">Y</a><a id="5710" class="Symbol">)</a> <a id="5712" class="Symbol">(</a><a id="5713" href="Effect.Handle.html#5713" class="Bound">x</a> <a id="5715" class="Symbol">:</a> <a id="5717" href="Core.Container.html#676" class="Record Operator">⟦</a> <a id="5719" href="Effect.Handle.html#4155" class="Bound">ε</a> <a id="5721" href="Core.Container.html#942" class="Function Operator">⊕ᶜ</a> <a id="5724" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="5727" href="Core.Container.html#676" class="Record Operator">⟧ᶜ</a> <a id="5730" class="Symbol">(</a><a id="5731" href="Effect.Handle.html#4209" class="Function">M</a> <a id="5733" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="5736" href="Effect.Handle.html#5689" class="Bound">X</a><a id="5737" class="Symbol">))</a>
      <a id="5746" class="Comment">---------------------------------------------------------------------------------</a>
    <a id="5832" class="Symbol">→</a> <a id="5834" class="Symbol">(</a><a id="5835" href="Effect.Handle.html#4345" class="Field">hdl</a> <a id="5839" href="Core.Container.html#1088" class="Function Operator">⟨⊕⟩ᶜ</a> <a id="5844" href="Effect.Handle.html#4873" class="Function">fwd</a><a id="5847" class="Symbol">)</a> <a id="5849" class="Symbol">.</a><a id="5850" href="Core.Container.html#844" class="Field">αᶜ</a> <a id="5853" class="Symbol">(</a><a id="5854" href="Core.Functor.html#495" class="Field">fmap</a> <a id="5859" class="Symbol">{</a><a id="5860" class="Argument">F</a> <a id="5862" class="Symbol">=</a> <a id="5864" href="Core.Container.html#676" class="Record Operator">⟦</a> <a id="5866" class="Symbol">_</a> <a id="5868" href="Core.Container.html#676" class="Record Operator">⟧ᶜ</a><a id="5870" class="Symbol">}</a> <a id="5872" class="Symbol">(</a><a id="5873" href="Core.Functor.html#495" class="Field">fmap</a> <a id="5878" href="Effect.Handle.html#5701" class="Bound">f</a><a id="5879" class="Symbol">)</a> <a id="5881" href="Effect.Handle.html#5713" class="Bound">x</a><a id="5882" class="Symbol">)</a> <a id="5884" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="5886" href="Core.Functor.html#495" class="Field">fmap</a> <a id="5891" href="Effect.Handle.html#5701" class="Bound">f</a> <a id="5893" class="Symbol">((</a><a id="5895" href="Effect.Handle.html#4345" class="Field">hdl</a> <a id="5899" href="Core.Container.html#1088" class="Function Operator">⟨⊕⟩ᶜ</a> <a id="5904" href="Effect.Handle.html#4873" class="Function">fwd</a><a id="5907" class="Symbol">)</a> <a id="5909" class="Symbol">.</a><a id="5910" href="Core.Container.html#844" class="Field">αᶜ</a> <a id="5913" href="Effect.Handle.html#5713" class="Bound">x</a><a id="5914" class="Symbol">)</a>
  <a id="5918" href="Effect.Handle.html#5664" class="Function">hdl-alg-commute</a> <a id="5934" href="Effect.Handle.html#5934" class="Bound">f</a> <a id="5936" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="5938" href="Data.Sum.Base.html#675" class="InductiveConstructor">inj₁</a> <a id="5943" href="Effect.Handle.html#5943" class="Bound">c</a> <a id="5945" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5947" href="Effect.Handle.html#5947" class="Bound">k</a> <a id="5949" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a>
    <a id="5955" class="Symbol">=</a> <a id="5957" href="Effect.Handle.html#4664" class="Field">hdl-commute</a> <a id="5969" href="Effect.Handle.html#5934" class="Bound">f</a> <a id="5971" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="5973" href="Effect.Handle.html#5943" class="Bound">c</a> <a id="5975" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="5977" href="Effect.Handle.html#5947" class="Bound">k</a> <a id="5979" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a>
  <a id="5983" href="Effect.Handle.html#5664" class="Function">hdl-alg-commute</a> <a id="5999" href="Effect.Handle.html#5999" class="Bound">f</a> <a id="6001" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="6003" href="Data.Sum.Base.html#700" class="InductiveConstructor">inj₂</a> <a id="6008" href="Effect.Handle.html#6008" class="Bound">c</a> <a id="6010" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6012" href="Effect.Handle.html#6012" class="Bound">k</a> <a id="6014" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a>
    <a id="6020" class="Symbol">=</a> <a id="6022" href="Effect.Handle.html#4959" class="Function">fwd-commute</a> <a id="6034" href="Effect.Handle.html#5999" class="Bound">f</a> <a id="6036" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="6038" class="Symbol">(</a><a id="6039" href="Effect.Handle.html#6008" class="Bound">c</a> <a id="6041" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6043" href="Effect.Handle.html#6012" class="Bound">k</a><a id="6044" class="Symbol">)</a> <a id="6046" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a>

  <a id="Handler.handle′"></a><a id="6051" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="6059" class="Symbol">:</a> <a id="6061" href="Relation.Unary.html#3629" class="Function">∀[</a> <a id="6064" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="6069" class="Symbol">(</a><a id="6070" href="Effect.Handle.html#4155" class="Bound">ε</a> <a id="6072" href="Core.Container.html#942" class="Function Operator">⊕ᶜ</a> <a id="6075" href="Effect.Base.html#924" class="Generalizable">ε₂</a><a id="6077" class="Symbol">)</a> <a id="6079" href="Relation.Unary.html#4621" class="Function Operator">⇒</a> <a id="6081" href="Function.Base.html#725" class="Function">const</a> <a id="6087" href="Effect.Handle.html#4168" class="Bound">P</a> <a id="6089" href="Relation.Unary.html#4621" class="Function Operator">⇒</a> <a id="6091" href="Effect.Handle.html#4178" class="Bound">F</a> <a id="6093" href="Relation.Unary.html#5366" class="Function Operator">⊢</a> <a id="6095" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="6100" href="Effect.Base.html#924" class="Generalizable">ε₂</a> <a id="6103" href="Relation.Unary.html#3629" class="Function">]</a>
  <a id="6107" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="6115" href="Effect.Handle.html#6115" class="Bound">m</a> <a id="6117" href="Effect.Handle.html#6117" class="Bound">x</a> <a id="6119" class="Symbol">=</a> <a id="6121" href="Effect.Syntax.Free.html#946" class="Function">fold-free</a> <a id="6131" href="Core.Functor.Monad.html#348" class="Field">return</a> <a id="6138" class="Symbol">(</a><a id="6139" href="Effect.Handle.html#4345" class="Field">hdl</a> <a id="6143" href="Core.Container.html#1088" class="Function Operator">⟨⊕⟩ᶜ</a> <a id="6148" href="Effect.Handle.html#4873" class="Function">fwd</a><a id="6151" class="Symbol">)</a> <a id="6153" href="Effect.Handle.html#6115" class="Bound">m</a> <a id="6155" href="Effect.Handle.html#6117" class="Bound">x</a> 

  <a id="Handler.handle"></a><a id="6161" href="Effect.Handle.html#6161" class="Function">handle</a> <a id="6168" class="Symbol">:</a> <a id="6170" href="Effect.Handle.html#4155" class="Bound">ε</a> <a id="6172" href="Core.Ternary.html#767" class="Field Operator">∙</a> <a id="6174" href="Effect.Base.html#924" class="Generalizable">ε₂</a> <a id="6177" href="Core.Ternary.html#767" class="Field Operator">≈</a> <a id="6179" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="6182" class="Symbol">→</a> <a id="6184" href="Relation.Unary.html#3629" class="Function">∀[</a> <a id="6187" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="6192" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="6195" href="Relation.Unary.html#4621" class="Function Operator">⇒</a> <a id="6197" href="Function.Base.html#725" class="Function">const</a> <a id="6203" href="Effect.Handle.html#4168" class="Bound">P</a> <a id="6205" href="Relation.Unary.html#4621" class="Function Operator">⇒</a> <a id="6207" href="Effect.Handle.html#4178" class="Bound">F</a> <a id="6209" href="Relation.Unary.html#5366" class="Function Operator">⊢</a> <a id="6211" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="6216" href="Effect.Base.html#924" class="Generalizable">ε₂</a> <a id="6219" href="Relation.Unary.html#3629" class="Function">]</a> 
  <a id="6224" href="Effect.Handle.html#6161" class="Function">handle</a> <a id="6231" href="Effect.Handle.html#6231" class="Bound">σ</a> <a id="6233" href="Effect.Handle.html#6233" class="Bound">m</a> <a id="6235" href="Effect.Handle.html#6235" class="Bound">x</a> <a id="6237" class="Symbol">=</a> <a id="6239" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="6247" class="Symbol">(</a><a id="6248" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="6256" href="Effect.Handle.html#6231" class="Bound">σ</a> <a id="6258" href="Effect.Handle.html#6233" class="Bound">m</a><a id="6259" class="Symbol">)</a> <a id="6261" href="Effect.Handle.html#6235" class="Bound">x</a>

  <a id="Handler.ℋ⟦_⟧"></a><a id="6266" href="Effect.Handle.html#6266" class="Function Operator">ℋ⟦_⟧</a> <a id="6271" class="Symbol">:</a> <a id="6273" class="Symbol">⦃</a> <a id="6275" href="Effect.Handle.html#4155" class="Bound">ε</a> <a id="6277" href="Core.Ternary.html#666" class="Field Operator">≲</a> <a id="6279" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="6282" class="Symbol">⦄</a> <a id="6284" class="Symbol">→</a> <a id="6286" href="Relation.Unary.html#3629" class="Function">∀[</a> <a id="6289" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="6294" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="6297" href="Relation.Unary.html#4621" class="Function Operator">⇒</a> <a id="6299" href="Function.Base.html#725" class="Function">const</a> <a id="6305" href="Effect.Handle.html#4168" class="Bound">P</a> <a id="6307" href="Relation.Unary.html#4621" class="Function Operator">⇒</a> <a id="6309" href="Effect.Handle.html#4178" class="Bound">F</a> <a id="6311" href="Relation.Unary.html#5366" class="Function Operator">⊢</a> <a id="6313" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="6318" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="6321" href="Relation.Unary.html#3629" class="Function">]</a>
  <a id="6325" href="Effect.Handle.html#6266" class="Function Operator">ℋ⟦_⟧</a> <a id="6330" class="Symbol">⦃</a> <a id="6332" href="Effect.Handle.html#6332" class="Bound">i</a> <a id="6334" class="Symbol">⦄</a> <a id="6336" href="Effect.Handle.html#6336" class="Bound">m</a> <a id="6338" class="Symbol">=</a> <a id="6340" href="Effect.Relation.Binary.FirstOrderInclusion.html#2013" class="Function">♯</a> <a id="6342" class="Symbol">⦃</a> <a id="6344" class="Symbol">_</a> <a id="6346" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="6348" href="Effect.Relation.Ternary.FirstOrderSeparation.html#2820" class="Function">union-comm</a> <a id="6359" class="Symbol">(</a><a id="6360" href="Effect.Handle.html#6332" class="Bound">i</a> <a id="6362" class="Symbol">.</a><a id="6363" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="6368" class="Symbol">)</a> <a id="6370" class="Symbol">⦄</a> <a id="6372" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="6374" href="Effect.Handle.html#6161" class="Function">handle</a> <a id="6381" class="Symbol">(</a><a id="6382" href="Effect.Handle.html#6332" class="Bound">i</a> <a id="6384" class="Symbol">.</a><a id="6385" href="Data.Product.Base.html#650" class="Field">proj₂</a><a id="6390" class="Symbol">)</a> <a id="6392" href="Effect.Handle.html#6336" class="Bound">m</a>

  <a id="Handler.ℋ⟪_⟫"></a><a id="6397" href="Effect.Handle.html#6397" class="Function Operator">ℋ⟪_⟫</a> <a id="6402" class="Symbol">:</a> <a id="6404" class="Symbol">⦃</a> <a id="6406" href="Effect.Handle.html#4155" class="Bound">ε</a> <a id="6408" href="Core.Ternary.html#666" class="Field Operator">≲</a> <a id="6410" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="6413" class="Symbol">⦄</a> <a id="6415" class="Symbol">→</a> <a id="6417" class="Symbol">(</a><a id="6418" href="Core.Functor.html#1514" class="Generalizable">A</a> <a id="6420" class="Symbol">→</a> <a id="6422" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="6427" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="6430" href="Core.Functor.html#1533" class="Generalizable">B</a><a id="6431" class="Symbol">)</a> <a id="6433" class="Symbol">→</a> <a id="6435" class="Symbol">(</a><a id="6436" href="Core.Functor.html#1514" class="Generalizable">A</a> <a id="6438" class="Symbol">→</a> <a id="6440" href="Effect.Handle.html#4168" class="Bound">P</a> <a id="6442" class="Symbol">→</a> <a id="6444" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="6449" href="Effect.Base.html#930" class="Generalizable">ε′</a> <a id="6452" class="Symbol">(</a><a id="6453" href="Effect.Handle.html#4178" class="Bound">F</a> <a id="6455" href="Core.Functor.html#1533" class="Generalizable">B</a><a id="6456" class="Symbol">))</a> 
  <a id="6462" href="Effect.Handle.html#6397" class="Function Operator">ℋ⟪</a> <a id="6465" href="Effect.Handle.html#6465" class="Bound">k</a> <a id="6467" href="Effect.Handle.html#6397" class="Function Operator">⟫</a> <a id="6469" href="Effect.Handle.html#6469" class="Bound">x</a> <a id="6471" class="Symbol">=</a> <a id="6473" href="Effect.Handle.html#6266" class="Function Operator">ℋ⟦</a> <a id="6476" href="Effect.Handle.html#6465" class="Bound">k</a> <a id="6478" href="Effect.Handle.html#6469" class="Bound">x</a> <a id="6480" href="Effect.Handle.html#6266" class="Function Operator">⟧</a> 

  <a id="Handler.⇑_"></a><a id="6486" href="Effect.Handle.html#6486" class="Function Operator">⇑_</a> <a id="6489" class="Symbol">:</a> <a id="6491" class="Symbol">∀</a> <a id="6493" class="Symbol">{</a><a id="6494" href="Effect.Handle.html#6494" class="Bound">ε</a><a id="6495" class="Symbol">}</a> <a id="6497" class="Symbol">→</a> <a id="6499" href="Relation.Unary.html#3629" class="Function">∀[</a> <a id="6502" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="6507" href="Effect.Handle.html#6494" class="Bound">ε</a> <a id="6509" href="Relation.Unary.html#4621" class="Function Operator">⇒</a> <a id="6511" href="Effect.Handle.html#4209" class="Function">M</a> <a id="6513" href="Effect.Handle.html#6494" class="Bound">ε</a> <a id="6515" href="Relation.Unary.html#3629" class="Function">]</a>
  <a id="6519" class="Symbol">(</a><a id="6520" href="Effect.Handle.html#6486" class="Function Operator">⇑</a> <a id="6522" href="Effect.Handle.html#6522" class="Bound">m</a><a id="6523" class="Symbol">)</a> <a id="6525" href="Effect.Handle.html#6525" class="Bound">p</a> <a id="6527" class="Symbol">=</a> <a id="6529" href="Effect.Handle.html#6522" class="Bound">m</a> <a id="6531" href="Core.Functor.Monad.html#423" class="Function Operator">&gt;&gt;=</a> <a id="6535" href="Function.Base.html#1638" class="Function">flip</a> <a id="6540" href="Core.Functor.Monad.html#348" class="Field">return</a> <a id="6547" href="Effect.Handle.html#6525" class="Bound">p</a>

  <a id="6552" class="Comment">{- Below we define some properties of handlers, which are necessary for
  writing proofs about elaborations that handle effects in sub-computations. -}</a> 


  <a id="6709" class="Comment">------------------</a>
  <a id="6730" class="Comment">--- Modularity ---</a>
  <a id="6751" class="Comment">------------------</a>

  <a id="Handler.Modular′"></a><a id="6773" href="Effect.Handle.html#6773" class="Function">Modular′</a> <a id="6782" class="Symbol">:</a> <a id="6784" href="Agda.Primitive.html#388" class="Primitive">Set₁</a>
  <a id="6791" href="Effect.Handle.html#6773" class="Function">Modular′</a> <a id="6800" class="Symbol">=</a>
    <a id="6806" class="Symbol">∀</a> <a id="6808" class="Symbol">{</a><a id="6809" href="Effect.Handle.html#6809" class="Bound">B</a> <a id="6811" href="Effect.Handle.html#6811" class="Bound">ε₂</a><a id="6813" class="Symbol">}</a> <a id="6815" class="Symbol">(</a><a id="6816" href="Effect.Handle.html#6816" class="Bound">m</a> <a id="6818" class="Symbol">:</a> <a id="6820" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="6825" href="Effect.Handle.html#6811" class="Bound">ε₂</a> <a id="6828" href="Effect.Handle.html#6809" class="Bound">B</a><a id="6829" class="Symbol">)</a>
      <a id="6837" class="Comment">------------------------</a>
    <a id="6866" class="Symbol">→</a> <a id="6868" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="6876" class="Symbol">(</a><a id="6877" href="Effect.Relation.Binary.FirstOrderInclusion.html#2154" class="Function">♯ʳ</a> <a id="6880" href="Effect.Handle.html#4155" class="Bound">ε</a> <a id="6882" href="Effect.Handle.html#6816" class="Bound">m</a><a id="6883" class="Symbol">)</a> <a id="6885" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="6887" href="Effect.Handle.html#6486" class="Function Operator">⇑</a> <a id="6889" href="Effect.Handle.html#6816" class="Bound">m</a> 
  
  <a id="6897" class="Comment">-- Defines &quot;modular handlers&quot;, that asserts that a handler leaves alone nodes in</a>
  <a id="6980" class="Comment">-- the tree containing commands of other effects than the effect it handles. </a>
  <a id="Handler.Modular"></a><a id="7060" href="Effect.Handle.html#7060" class="Function">Modular</a> <a id="7068" class="Symbol">:</a> <a id="7070" href="Agda.Primitive.html#388" class="Primitive">Set₁</a>
  <a id="7077" href="Effect.Handle.html#7060" class="Function">Modular</a> <a id="7085" class="Symbol">=</a>
    <a id="7091" class="Symbol">∀</a> <a id="7093" class="Symbol">{</a><a id="7094" href="Effect.Handle.html#7094" class="Bound">B</a> <a id="7096" href="Effect.Handle.html#7096" class="Bound">ε₂</a> <a id="7099" href="Effect.Handle.html#7099" class="Bound">ε′</a><a id="7101" class="Symbol">}</a> <a id="7103" class="Symbol">(</a><a id="7104" href="Effect.Handle.html#7104" class="Bound">m</a> <a id="7106" class="Symbol">:</a> <a id="7108" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="7113" href="Effect.Handle.html#7096" class="Bound">ε₂</a> <a id="7116" href="Effect.Handle.html#7094" class="Bound">B</a><a id="7117" class="Symbol">)</a>
    <a id="7123" class="Symbol">→</a> <a id="7125" class="Symbol">(</a><a id="7126" href="Effect.Handle.html#7126" class="Bound">σ</a> <a id="7128" class="Symbol">:</a> <a id="7130" href="Effect.Handle.html#4155" class="Bound">ε</a> <a id="7132" href="Core.Ternary.html#767" class="Field Operator">∙</a> <a id="7134" href="Effect.Handle.html#7096" class="Bound">ε₂</a> <a id="7137" href="Core.Ternary.html#767" class="Field Operator">≈</a> <a id="7139" href="Effect.Handle.html#7099" class="Bound">ε′</a><a id="7141" class="Symbol">)</a>
      <a id="7149" class="Comment">--------------------------------------</a>
    <a id="7192" class="Symbol">→</a> <a id="7194" href="Effect.Handle.html#6161" class="Function">handle</a> <a id="7201" href="Effect.Handle.html#7126" class="Bound">σ</a> <a id="7203" class="Symbol">(</a><a id="7204" href="Effect.Relation.Binary.FirstOrderInclusion.html#2308" class="Function">♯ʳ′</a> <a id="7208" href="Effect.Handle.html#7126" class="Bound">σ</a> <a id="7210" href="Effect.Handle.html#7104" class="Bound">m</a><a id="7211" class="Symbol">)</a> <a id="7213" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7215" href="Effect.Handle.html#6486" class="Function Operator">⇑</a> <a id="7217" href="Effect.Handle.html#7104" class="Bound">m</a>


  <a id="7223" class="Comment">-----------------</a>
  <a id="7243" class="Comment">--- Coherence ---</a>
  <a id="7263" class="Comment">-----------------</a>

  <a id="Handler.Coherent′"></a><a id="7284" href="Effect.Handle.html#7284" class="Function">Coherent′</a> <a id="7294" class="Symbol">:</a> <a id="7296" href="Agda.Primitive.html#388" class="Primitive">Set₁</a>
  <a id="7303" href="Effect.Handle.html#7284" class="Function">Coherent′</a> <a id="7313" class="Symbol">=</a>
    <a id="7319" class="Symbol">∀</a> <a id="7321" class="Symbol">{</a><a id="7322" href="Effect.Handle.html#7322" class="Bound">B</a> <a id="7324" href="Effect.Handle.html#7324" class="Bound">C</a> <a id="7326" href="Effect.Handle.html#7326" class="Bound">ε₂</a><a id="7328" class="Symbol">}</a>
    <a id="7334" class="Symbol">→</a> <a id="7336" class="Symbol">(</a><a id="7337" href="Effect.Handle.html#7337" class="Bound">m</a> <a id="7339" class="Symbol">:</a> <a id="7341" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="7346" class="Symbol">(</a><a id="7347" href="Effect.Handle.html#4155" class="Bound">ε</a> <a id="7349" href="Core.Container.html#942" class="Function Operator">⊕ᶜ</a> <a id="7352" href="Effect.Handle.html#7326" class="Bound">ε₂</a><a id="7354" class="Symbol">)</a> <a id="7356" href="Effect.Handle.html#7322" class="Bound">B</a><a id="7357" class="Symbol">)</a> <a id="7359" class="Symbol">(</a><a id="7360" href="Effect.Handle.html#7360" class="Bound">k</a> <a id="7362" class="Symbol">:</a> <a id="7364" href="Effect.Handle.html#7322" class="Bound">B</a> <a id="7366" class="Symbol">→</a> <a id="7368" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="7373" class="Symbol">(</a><a id="7374" href="Effect.Handle.html#4155" class="Bound">ε</a> <a id="7376" href="Core.Container.html#942" class="Function Operator">⊕ᶜ</a> <a id="7379" href="Effect.Handle.html#7326" class="Bound">ε₂</a><a id="7381" class="Symbol">)</a> <a id="7383" href="Effect.Handle.html#7324" class="Bound">C</a><a id="7384" class="Symbol">)</a>
      <a id="7392" class="Comment">-----------------------------------------------------------</a>
    <a id="7456" class="Symbol">→</a> <a id="7458" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="7466" class="Symbol">{</a><a id="7467" class="Argument">ε₂</a> <a id="7470" class="Symbol">=</a> <a id="7472" href="Effect.Handle.html#7326" class="Bound">ε₂</a><a id="7474" class="Symbol">}</a> <a id="7476" class="Symbol">(</a><a id="7477" href="Effect.Handle.html#7337" class="Bound">m</a> <a id="7479" href="Core.Functor.Monad.html#423" class="Function Operator">&gt;&gt;=</a> <a id="7483" href="Effect.Handle.html#7360" class="Bound">k</a><a id="7484" class="Symbol">)</a> <a id="7486" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7488" class="Symbol">(</a><a id="7489" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="7497" href="Effect.Handle.html#7337" class="Bound">m</a><a id="7498" class="Symbol">)</a> <a id="7500" href="Core.Functor.Monad.html#423" class="Function Operator">&gt;&gt;=</a> <a id="7504" class="Symbol">(</a><a id="7505" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="7513" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="7515" href="Effect.Handle.html#7360" class="Bound">k</a><a id="7516" class="Symbol">)</a>


  <a id="Handler.Coherent"></a><a id="7522" href="Effect.Handle.html#7522" class="Function">Coherent</a> <a id="7531" class="Symbol">:</a> <a id="7533" href="Agda.Primitive.html#388" class="Primitive">Set₁</a>
  <a id="7540" href="Effect.Handle.html#7522" class="Function">Coherent</a> <a id="7549" class="Symbol">=</a>
    <a id="7555" class="Symbol">∀</a> <a id="7557" class="Symbol">{</a><a id="7558" href="Effect.Handle.html#7558" class="Bound">B</a> <a id="7560" href="Effect.Handle.html#7560" class="Bound">C</a> <a id="7562" href="Effect.Handle.html#7562" class="Bound">ε₂</a> <a id="7565" href="Effect.Handle.html#7565" class="Bound">ε′</a><a id="7567" class="Symbol">}</a>
    <a id="7573" class="Symbol">→</a> <a id="7575" class="Symbol">(</a><a id="7576" href="Effect.Handle.html#7576" class="Bound">σ</a> <a id="7578" class="Symbol">:</a> <a id="7580" href="Effect.Handle.html#4155" class="Bound">ε</a> <a id="7582" href="Core.Ternary.html#767" class="Field Operator">∙</a> <a id="7584" href="Effect.Handle.html#7562" class="Bound">ε₂</a> <a id="7587" href="Core.Ternary.html#767" class="Field Operator">≈</a> <a id="7589" href="Effect.Handle.html#7565" class="Bound">ε′</a><a id="7591" class="Symbol">)</a>
    <a id="7597" class="Symbol">→</a> <a id="7599" class="Symbol">(</a><a id="7600" href="Effect.Handle.html#7600" class="Bound">m</a> <a id="7602" class="Symbol">:</a> <a id="7604" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="7609" href="Effect.Handle.html#7565" class="Bound">ε′</a> <a id="7612" href="Effect.Handle.html#7558" class="Bound">B</a><a id="7613" class="Symbol">)</a> <a id="7615" class="Symbol">(</a><a id="7616" href="Effect.Handle.html#7616" class="Bound">k</a> <a id="7618" class="Symbol">:</a> <a id="7620" href="Effect.Handle.html#7558" class="Bound">B</a> <a id="7622" class="Symbol">→</a> <a id="7624" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="7629" href="Effect.Handle.html#7565" class="Bound">ε′</a> <a id="7632" href="Effect.Handle.html#7560" class="Bound">C</a><a id="7633" class="Symbol">)</a>
      <a id="7641" class="Comment">-------------------------------------------------</a>
    <a id="7695" class="Symbol">→</a> <a id="7697" href="Effect.Handle.html#6161" class="Function">handle</a> <a id="7704" href="Effect.Handle.html#7576" class="Bound">σ</a> <a id="7706" class="Symbol">(</a><a id="7707" href="Effect.Handle.html#7600" class="Bound">m</a> <a id="7709" href="Core.Functor.Monad.html#423" class="Function Operator">&gt;&gt;=</a> <a id="7713" href="Effect.Handle.html#7616" class="Bound">k</a><a id="7714" class="Symbol">)</a> <a id="7716" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="7718" href="Effect.Handle.html#6161" class="Function">handle</a> <a id="7725" href="Effect.Handle.html#7576" class="Bound">σ</a> <a id="7727" href="Effect.Handle.html#7600" class="Bound">m</a> <a id="7729" href="Core.Functor.Monad.html#423" class="Function Operator">&gt;&gt;=</a> <a id="7733" href="Effect.Handle.html#6161" class="Function">handle</a> <a id="7740" href="Effect.Handle.html#7576" class="Bound">σ</a> <a id="7742" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="7744" href="Effect.Handle.html#7616" class="Bound">k</a>

  <a id="Handler.reordering-preserves-modularity"></a><a id="7749" href="Effect.Handle.html#7749" class="Function">reordering-preserves-modularity</a> <a id="7781" class="Symbol">:</a> <a id="7783" href="Effect.Handle.html#6773" class="Function">Modular′</a> <a id="7792" class="Symbol">→</a> <a id="7794" href="Effect.Handle.html#7060" class="Function">Modular</a>
  <a id="7804" href="Effect.Handle.html#7749" class="Function">reordering-preserves-modularity</a> <a id="7836" href="Effect.Handle.html#7836" class="Bound">mod</a> <a id="7840" href="Effect.Handle.html#7840" class="Bound">m</a> <a id="7842" href="Effect.Handle.html#7842" class="Bound">σ</a> <a id="7844" class="Symbol">=</a>
    <a id="7850" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
      <a id="7862" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="7870" class="Symbol">(</a><a id="7871" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="7879" href="Effect.Handle.html#7842" class="Bound">σ</a> <a id="7881" class="Symbol">(</a><a id="7882" href="Effect.Relation.Binary.FirstOrderInclusion.html#2308" class="Function">♯ʳ′</a> <a id="7886" href="Effect.Handle.html#7842" class="Bound">σ</a> <a id="7888" href="Effect.Handle.html#7840" class="Bound">m</a><a id="7889" class="Symbol">))</a>
    <a id="7896" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="7899" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="7904" class="Symbol">(λ</a> <a id="7907" href="Effect.Handle.html#7907" class="Bound">○</a> <a id="7909" class="Symbol">→</a> <a id="7911" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="7919" href="Effect.Handle.html#7907" class="Bound">○</a><a id="7920" class="Symbol">)</a> <a id="7922" class="Symbol">(</a><a id="7923" href="Effect.Handle.html#3211" class="Function">weaken-lemma</a> <a id="7936" href="Effect.Handle.html#7842" class="Bound">σ</a> <a id="7938" href="Effect.Handle.html#7840" class="Bound">m</a><a id="7939" class="Symbol">)</a> <a id="7941" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a>
      <a id="7949" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="7957" class="Symbol">(</a><a id="7958" href="Effect.Relation.Binary.FirstOrderInclusion.html#2154" class="Function">♯ʳ</a> <a id="7961" href="Effect.Handle.html#4155" class="Bound">ε</a> <a id="7963" href="Effect.Handle.html#7840" class="Bound">m</a><a id="7964" class="Symbol">)</a> 
    <a id="7971" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="7974" href="Effect.Handle.html#7836" class="Bound">mod</a> <a id="7978" href="Effect.Handle.html#7840" class="Bound">m</a> <a id="7980" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a> 
      <a id="7989" href="Effect.Handle.html#6486" class="Function Operator">⇑</a> <a id="7991" href="Effect.Handle.html#7840" class="Bound">m</a>
    <a id="7997" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
    <a id="8003" class="Keyword">where</a> <a id="8009" class="Keyword">open</a> <a id="8014" href="Relation.Binary.PropositionalEquality.Properties.html#6744" class="Module">≡-Reasoning</a> 

  <a id="Handler.reordering-preserves-coherence"></a><a id="8030" href="Effect.Handle.html#8030" class="Function">reordering-preserves-coherence</a> <a id="8061" class="Symbol">:</a> <a id="8063" href="Effect.Handle.html#7284" class="Function">Coherent′</a> <a id="8073" class="Symbol">→</a> <a id="8075" href="Effect.Handle.html#7522" class="Function">Coherent</a>
  <a id="8086" href="Effect.Handle.html#8030" class="Function">reordering-preserves-coherence</a> <a id="8117" href="Effect.Handle.html#8117" class="Bound">C</a> <a id="8119" href="Effect.Handle.html#8119" class="Bound">σ</a> <a id="8121" href="Effect.Handle.html#8121" class="Bound">m</a> <a id="8123" href="Effect.Handle.html#8123" class="Bound">k</a> <a id="8125" class="Symbol">=</a> 
    <a id="8132" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
      <a id="8144" href="Effect.Handle.html#6161" class="Function">handle</a> <a id="8151" href="Effect.Handle.html#8119" class="Bound">σ</a> <a id="8153" class="Symbol">(</a><a id="8154" href="Effect.Handle.html#8121" class="Bound">m</a> <a id="8156" href="Core.Functor.Monad.html#423" class="Function Operator">&gt;&gt;=</a> <a id="8160" href="Effect.Handle.html#8123" class="Bound">k</a><a id="8161" class="Symbol">)</a>
    <a id="8167" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a> 
      <a id="8178" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="8186" class="Symbol">(</a><a id="8187" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="8195" href="Effect.Handle.html#8119" class="Bound">σ</a> <a id="8197" class="Symbol">(</a><a id="8198" href="Effect.Handle.html#8121" class="Bound">m</a> <a id="8200" href="Core.Functor.Monad.html#423" class="Function Operator">&gt;&gt;=</a> <a id="8204" href="Effect.Handle.html#8123" class="Bound">k</a><a id="8205" class="Symbol">))</a>
    <a id="8212" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="8215" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="8220" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="8228" class="Symbol">(</a><a id="8229" href="Effect.Handle.html#1844" class="Function">reorder-coherent</a> <a id="8246" href="Effect.Handle.html#8121" class="Bound">m</a> <a id="8248" href="Effect.Handle.html#8123" class="Bound">k</a> <a id="8250" href="Effect.Handle.html#8119" class="Bound">σ</a><a id="8251" class="Symbol">)</a> <a id="8253" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a> 
      <a id="8262" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="8270" class="Symbol">(</a><a id="8271" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="8279" href="Effect.Handle.html#8119" class="Bound">σ</a> <a id="8281" href="Effect.Handle.html#8121" class="Bound">m</a> <a id="8283" href="Core.Functor.Monad.html#423" class="Function Operator">&gt;&gt;=</a> <a id="8287" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="8295" href="Effect.Handle.html#8119" class="Bound">σ</a> <a id="8297" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="8299" href="Effect.Handle.html#8123" class="Bound">k</a><a id="8300" class="Symbol">)</a>
    <a id="8306" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="8309" href="Effect.Handle.html#8117" class="Bound">C</a> <a id="8311" class="Symbol">(</a><a id="8312" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="8320" href="Effect.Handle.html#8119" class="Bound">σ</a> <a id="8322" href="Effect.Handle.html#8121" class="Bound">m</a><a id="8323" class="Symbol">)</a> <a id="8325" class="Symbol">(</a><a id="8326" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="8334" href="Effect.Handle.html#8119" class="Bound">σ</a> <a id="8336" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="8338" href="Effect.Handle.html#8123" class="Bound">k</a><a id="8339" class="Symbol">)</a> <a id="8341" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a> 
      <a id="8350" href="Effect.Handle.html#6161" class="Function">handle</a> <a id="8357" href="Effect.Handle.html#8119" class="Bound">σ</a> <a id="8359" href="Effect.Handle.html#8121" class="Bound">m</a> <a id="8361" href="Core.Functor.Monad.html#423" class="Function Operator">&gt;&gt;=</a> <a id="8365" href="Effect.Handle.html#6161" class="Function">handle</a> <a id="8372" href="Effect.Handle.html#8119" class="Bound">σ</a> <a id="8374" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="8376" href="Effect.Handle.html#8123" class="Bound">k</a>
    <a id="8382" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
    <a id="8388" class="Keyword">where</a> <a id="8394" class="Keyword">open</a> <a id="8399" href="Relation.Binary.PropositionalEquality.Properties.html#6744" class="Module">≡-Reasoning</a>


  <a id="8415" class="Comment">-- Proves the &quot;stricter&quot; notion of modularity for handlers, i.e., if the effect</a>
  <a id="8497" class="Comment">-- to be handled is already at the front</a>
  <a id="Handler.handle-modular′"></a><a id="8540" href="Effect.Handle.html#8540" class="Function">handle-modular′</a> <a id="8556" class="Symbol">:</a> <a id="8558" href="Effect.Handle.html#6773" class="Function">Modular′</a>
  <a id="8569" href="Effect.Handle.html#8540" class="Function">handle-modular′</a>     <a id="8589" class="Symbol">(</a><a id="8590" href="Effect.Syntax.Free.html#529" class="InductiveConstructor">pure</a> <a id="8595" href="Effect.Handle.html#8595" class="Bound">x</a><a id="8596" class="Symbol">)</a>           <a id="8608" class="Symbol">=</a> <a id="8610" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
  <a id="8617" href="Effect.Handle.html#8540" class="Function">handle-modular′</a>     <a id="8637" class="Symbol">(</a><a id="8638" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="8645" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="8647" href="Effect.Handle.html#8647" class="Bound">c</a> <a id="8649" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8651" href="Effect.Handle.html#8651" class="Bound">r</a> <a id="8653" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="8654" class="Symbol">)</a> <a id="8656" class="Symbol">=</a> <a id="8658" href="Core.Extensionality.html#201" class="Function">extensionality</a> <a id="8673" class="Symbol">λ</a> <a id="8675" href="Effect.Handle.html#8675" class="Bound">p</a> <a id="8677" class="Symbol">→</a>
    <a id="8683" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
      <a id="8695" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="8703" class="Symbol">(</a><a id="8704" href="Effect.Relation.Binary.FirstOrderInclusion.html#2154" class="Function">♯ʳ</a> <a id="8707" href="Effect.Handle.html#4155" class="Bound">ε</a> <a id="8709" class="Symbol">(</a><a id="8710" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="8717" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="8719" href="Effect.Handle.html#8647" class="Bound">c</a> <a id="8721" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8723" href="Effect.Handle.html#8651" class="Bound">r</a> <a id="8725" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="8726" class="Symbol">))</a> <a id="8729" href="Effect.Handle.html#8675" class="Bound">p</a>
    <a id="8735" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="8738" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="8743" class="Symbol">(λ</a> <a id="8746" href="Effect.Handle.html#8746" class="Bound">○</a> <a id="8748" class="Symbol">→</a> <a id="8750" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="8757" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="8759" href="Effect.Handle.html#8647" class="Bound">c</a> <a id="8761" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8763" href="Effect.Handle.html#8746" class="Bound">○</a> <a id="8765" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="8766" class="Symbol">)</a> <a id="8768" class="Symbol">(</a><a id="8769" href="Core.Extensionality.html#201" class="Function">extensionality</a> <a id="8784" class="Symbol">λ</a> <a id="8786" href="Effect.Handle.html#8786" class="Bound">x</a> <a id="8788" class="Symbol">→</a> <a id="8790" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="8795" class="Symbol">(</a><a id="8796" href="Function.Base.html#1974" class="Function Operator">_$</a> <a id="8799" href="Effect.Handle.html#8675" class="Bound">p</a><a id="8800" class="Symbol">)</a> <a id="8802" href="Function.Base.html#1974" class="Function Operator">$</a> <a id="8804" href="Effect.Handle.html#8540" class="Function">handle-modular′</a> <a id="8820" class="Symbol">(</a><a id="8821" href="Effect.Handle.html#8651" class="Bound">r</a> <a id="8823" href="Effect.Handle.html#8786" class="Bound">x</a><a id="8824" class="Symbol">))</a> <a id="8827" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a>
      <a id="8835" class="Symbol">(</a><a id="8836" href="Effect.Handle.html#6486" class="Function Operator">⇑</a> <a id="8838" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="8845" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="8847" href="Effect.Handle.html#8647" class="Bound">c</a> <a id="8849" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="8851" href="Effect.Handle.html#8651" class="Bound">r</a> <a id="8853" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="8854" class="Symbol">)</a> <a id="8856" href="Effect.Handle.html#8675" class="Bound">p</a>
    <a id="8862" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
    <a id="8868" class="Keyword">where</a> <a id="8874" class="Keyword">open</a> <a id="8879" href="Relation.Binary.PropositionalEquality.Properties.html#6744" class="Module">≡-Reasoning</a>

  <a id="8894" class="Comment">-- All handlers are modular </a>
  <a id="Handler.handle-modular"></a><a id="8925" href="Effect.Handle.html#8925" class="Function">handle-modular</a> <a id="8940" class="Symbol">:</a> <a id="8942" href="Effect.Handle.html#7060" class="Function">Modular</a>
  <a id="8952" href="Effect.Handle.html#8925" class="Function">handle-modular</a> <a id="8967" class="Symbol">=</a> <a id="8969" href="Effect.Handle.html#7749" class="Function">reordering-preserves-modularity</a> <a id="9001" href="Effect.Handle.html#8540" class="Function">handle-modular′</a>


  <a id="9021" class="Comment">-- Proves that handlers are natural transformations</a>
  <a id="9075" class="Keyword">module</a> <a id="9082" href="Effect.Handle.html#9082" class="Module">_</a> <a id="9084" class="Keyword">where</a> 

    <a id="9096" class="Keyword">instance</a> <a id="9105" href="Effect.Handle.html#9105" class="Function">foo</a> <a id="9109" class="Symbol">:</a> <a id="9111" class="Symbol">∀</a> <a id="9113" class="Symbol">{</a><a id="9114" href="Effect.Handle.html#9114" class="Bound">ε</a><a id="9115" class="Symbol">}</a> <a id="9117" class="Symbol">→</a> <a id="9119" href="Core.Functor.html#424" class="Record">Functor</a> <a id="9127" class="Symbol">(</a><a id="9128" href="Effect.Handle.html#4209" class="Function">M</a> <a id="9130" href="Effect.Handle.html#9114" class="Bound">ε</a><a id="9131" class="Symbol">)</a> 
    <a id="9138" href="Effect.Handle.html#9105" class="Function">foo</a> <a id="9142" class="Symbol">=</a> <a id="9144" href="Effect.Handle.html#4310" class="Field">M-monad</a> <a id="9152" class="Symbol">.</a><a id="9153" href="Core.Functor.Monad.html#318" class="Field">F-functor</a>

    <a id="9168" href="Effect.Handle.html#9168" class="Function">handle-natural</a> <a id="9183" class="Symbol">:</a> <a id="9185" class="Symbol">(</a><a id="9186" href="Effect.Handle.html#9186" class="Bound">σ</a> <a id="9188" class="Symbol">:</a> <a id="9190" href="Effect.Handle.html#4155" class="Bound">ε</a> <a id="9192" href="Core.Ternary.html#767" class="Field Operator">∙</a> <a id="9194" href="Effect.Base.html#924" class="Generalizable">ε₂</a> <a id="9197" href="Core.Ternary.html#767" class="Field Operator">≈</a> <a id="9199" href="Effect.Handle.html#4155" class="Bound">ε</a><a id="9200" class="Symbol">)</a> <a id="9202" class="Symbol">→</a> <a id="9204" href="Core.Functor.NaturalTransformation.html#436" class="Record">Natural</a> <a id="9212" class="Symbol">(</a><a id="9213" href="Effect.Handle.html#6161" class="Function">handle</a> <a id="9220" href="Effect.Handle.html#9186" class="Bound">σ</a><a id="9221" class="Symbol">)</a>
    <a id="9227" href="Effect.Handle.html#9168" class="Function">handle-natural</a> <a id="9242" class="Symbol">{</a><a id="9243" class="Argument">ε₂</a> <a id="9246" class="Symbol">=</a> <a id="9248" href="Effect.Handle.html#9248" class="Bound">ε₂</a><a id="9250" class="Symbol">}</a> <a id="9252" href="Effect.Handle.html#9252" class="Bound">σ</a> <a id="9254" class="Symbol">.</a><a id="9255" href="Core.Functor.NaturalTransformation.html#590" class="Field">commute</a> <a id="9263" class="Symbol">{</a><a id="9264" href="Effect.Handle.html#9264" class="Bound">X</a><a id="9265" class="Symbol">}</a> <a id="9267" class="Symbol">{</a><a id="9268" href="Effect.Handle.html#9268" class="Bound">Y</a><a id="9269" class="Symbol">}</a> <a id="9271" class="Symbol">{</a><a id="9272" class="Argument">f</a> <a id="9274" class="Symbol">=</a> <a id="9276" href="Effect.Handle.html#9276" class="Bound">f</a><a id="9277" class="Symbol">}</a> <a id="9279" class="Symbol">=</a> <a id="9281" href="Effect.Handle.html#9342" class="Function">handle-commute</a>

      <a id="9303" class="Keyword">where</a>
        <a id="9317" class="Keyword">open</a> <a id="9322" href="Relation.Binary.PropositionalEquality.Properties.html#6744" class="Module">≡-Reasoning</a>
        <a id="9342" href="Effect.Handle.html#9342" class="Function">handle-commute</a> <a id="9357" class="Symbol">:</a> <a id="9359" class="Symbol">∀</a> <a id="9361" href="Effect.Handle.html#9361" class="Bound">m</a> <a id="9363" class="Symbol">→</a> <a id="9365" href="Effect.Handle.html#6161" class="Function">handle</a> <a id="9372" href="Effect.Handle.html#9252" class="Bound">σ</a> <a id="9374" class="Symbol">(</a><a id="9375" href="Core.Functor.html#495" class="Field">fmap</a> <a id="9380" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="9382" href="Effect.Handle.html#9361" class="Bound">m</a><a id="9383" class="Symbol">)</a> <a id="9385" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="9387" href="Core.Functor.html#495" class="Field">fmap</a> <a id="9392" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="9394" class="Symbol">(</a><a id="9395" href="Effect.Handle.html#6161" class="Function">handle</a> <a id="9402" href="Effect.Handle.html#9252" class="Bound">σ</a> <a id="9404" href="Effect.Handle.html#9361" class="Bound">m</a><a id="9405" class="Symbol">)</a> 
        <a id="9416" href="Effect.Handle.html#9342" class="Function">handle-commute</a> <a id="9431" href="Effect.Handle.html#9431" class="Bound">m</a>  <a id="9434" class="Symbol">=</a>
          <a id="9446" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
            <a id="9464" href="Effect.Handle.html#6161" class="Function">handle</a> <a id="9471" href="Effect.Handle.html#9252" class="Bound">σ</a> <a id="9473" class="Symbol">(</a><a id="9474" href="Core.Functor.html#495" class="Field">fmap</a> <a id="9479" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="9481" href="Effect.Handle.html#9431" class="Bound">m</a><a id="9482" class="Symbol">)</a>
          <a id="9494" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a> 
            <a id="9511" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="9519" class="Symbol">(</a><a id="9520" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="9528" href="Effect.Handle.html#9252" class="Bound">σ</a> <a id="9530" class="Symbol">(</a><a id="9531" href="Core.Functor.html#495" class="Field">fmap</a> <a id="9536" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="9538" href="Effect.Handle.html#9431" class="Bound">m</a><a id="9539" class="Symbol">))</a>
          <a id="9552" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="9555" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="9560" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="9568" class="Symbol">(</a><a id="9569" href="Effect.Handle.html#2818" class="Function">reorder-natural</a> <a id="9585" href="Effect.Handle.html#9252" class="Bound">σ</a> <a id="9587" class="Symbol">.</a><a id="9588" href="Core.Functor.NaturalTransformation.html#590" class="Field">commute</a> <a id="9596" href="Effect.Handle.html#9431" class="Bound">m</a><a id="9597" class="Symbol">)</a> <a id="9599" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a>
            <a id="9613" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="9621" class="Symbol">(</a><a id="9622" href="Core.Functor.html#495" class="Field">fmap</a> <a id="9627" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="9629" class="Symbol">(</a><a id="9630" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="9638" href="Effect.Handle.html#9252" class="Bound">σ</a> <a id="9640" href="Effect.Handle.html#9431" class="Bound">m</a><a id="9641" class="Symbol">))</a> 
          <a id="9655" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="9658" href="Effect.Handle.html#9834" class="Function">handle′-commute</a> <a id="9674" class="Symbol">(</a><a id="9675" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="9683" href="Effect.Handle.html#9252" class="Bound">σ</a> <a id="9685" href="Effect.Handle.html#9431" class="Bound">m</a><a id="9686" class="Symbol">)</a> <a id="9688" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a> 
            <a id="9703" href="Core.Functor.html#495" class="Field">fmap</a> <a id="9708" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="9710" class="Symbol">(</a><a id="9711" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="9719" class="Symbol">(</a><a id="9720" href="Effect.Handle.html#1010" class="Function">reorder</a> <a id="9728" href="Effect.Handle.html#9252" class="Bound">σ</a> <a id="9730" href="Effect.Handle.html#9431" class="Bound">m</a><a id="9731" class="Symbol">))</a>
          <a id="9744" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a> 
            <a id="9761" href="Core.Functor.html#495" class="Field">fmap</a> <a id="9766" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="9768" class="Symbol">(</a><a id="9769" href="Effect.Handle.html#6161" class="Function">handle</a> <a id="9776" href="Effect.Handle.html#9252" class="Bound">σ</a> <a id="9778" href="Effect.Handle.html#9431" class="Bound">m</a><a id="9779" class="Symbol">)</a>
          <a id="9791" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
          <a id="9803" class="Keyword">where</a>
            
            <a id="9834" href="Effect.Handle.html#9834" class="Function">handle′-commute</a> <a id="9850" class="Symbol">:</a> <a id="9852" class="Symbol">(</a><a id="9853" href="Effect.Handle.html#9853" class="Bound">m</a> <a id="9855" class="Symbol">:</a> <a id="9857" href="Effect.Syntax.Free.html#483" class="Datatype">Free</a> <a id="9862" class="Symbol">(</a><a id="9863" href="Effect.Handle.html#4155" class="Bound">ε</a> <a id="9865" href="Core.Container.html#942" class="Function Operator">⊕ᶜ</a> <a id="9868" href="Effect.Handle.html#9248" class="Bound">ε₂</a><a id="9870" class="Symbol">)</a> <a id="9872" href="Effect.Handle.html#9264" class="Bound">X</a><a id="9873" class="Symbol">)</a> <a id="9875" class="Symbol">→</a> <a id="9877" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="9885" class="Symbol">{</a><a id="9886" class="Argument">ε₂</a> <a id="9889" class="Symbol">=</a> <a id="9891" href="Effect.Handle.html#9248" class="Bound">ε₂</a><a id="9893" class="Symbol">}</a> <a id="9895" class="Symbol">(</a><a id="9896" href="Core.Functor.html#495" class="Field">fmap</a> <a id="9901" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="9903" href="Effect.Handle.html#9853" class="Bound">m</a><a id="9904" class="Symbol">)</a>  <a id="9907" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="9909" href="Core.Functor.html#495" class="Field">fmap</a> <a id="9914" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="9916" class="Symbol">(</a><a id="9917" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="9925" href="Effect.Handle.html#9853" class="Bound">m</a><a id="9926" class="Symbol">)</a> 
            <a id="9941" href="Effect.Handle.html#9834" class="Function">handle′-commute</a> <a id="9957" class="Symbol">(</a><a id="9958" href="Effect.Syntax.Free.html#529" class="InductiveConstructor">pure</a> <a id="9963" href="Effect.Handle.html#9963" class="Bound">x</a><a id="9964" class="Symbol">)</a>           <a id="9976" class="Symbol">=</a>
              <a id="9992" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
                <a id="10014" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="10022" class="Symbol">(</a><a id="10023" href="Core.Functor.html#495" class="Field">fmap</a> <a id="10028" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="10030" class="Symbol">(</a><a id="10031" href="Effect.Syntax.Free.html#529" class="InductiveConstructor">pure</a> <a id="10036" href="Effect.Handle.html#9963" class="Bound">x</a><a id="10037" class="Symbol">))</a>
              <a id="10054" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a>
                <a id="10074" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="10082" class="Symbol">(</a><a id="10083" href="Effect.Syntax.Free.html#529" class="InductiveConstructor">pure</a> <a id="10088" class="Symbol">(</a><a id="10089" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="10091" href="Effect.Handle.html#9963" class="Bound">x</a><a id="10092" class="Symbol">))</a>
              <a id="10109" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a> 
                <a id="10130" href="Core.Functor.Monad.html#348" class="Field">return</a> <a id="10137" class="Symbol">(</a><a id="10138" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="10140" href="Effect.Handle.html#9963" class="Bound">x</a><a id="10141" class="Symbol">)</a>
              <a id="10157" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="10160" href="Core.Functor.Monad.html#1123" class="Field">return-natural</a> <a id="10175" class="Symbol">.</a><a id="10176" href="Core.Functor.NaturalTransformation.html#590" class="Field">commute</a> <a id="10184" href="Effect.Handle.html#9963" class="Bound">x</a> <a id="10186" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a>
                <a id="10204" href="Core.Functor.html#495" class="Field">fmap</a> <a id="10209" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="10211" class="Symbol">(</a><a id="10212" href="Core.Functor.Monad.html#348" class="Field">return</a> <a id="10219" href="Effect.Handle.html#9963" class="Bound">x</a><a id="10220" class="Symbol">)</a>
              <a id="10236" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a> 
                <a id="10257" href="Core.Functor.html#495" class="Field">fmap</a> <a id="10262" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="10264" class="Symbol">(</a><a id="10265" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="10273" class="Symbol">(</a><a id="10274" href="Effect.Syntax.Free.html#529" class="InductiveConstructor">pure</a> <a id="10279" href="Effect.Handle.html#9963" class="Bound">x</a><a id="10280" class="Symbol">))</a>
              <a id="10297" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>
            <a id="10311" href="Effect.Handle.html#9834" class="Function">handle′-commute</a> <a id="10327" class="Symbol">(</a><a id="10328" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="10335" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="10337" href="Effect.Handle.html#10337" class="Bound">c</a> <a id="10339" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10341" href="Effect.Handle.html#10341" class="Bound">k</a> <a id="10343" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="10344" class="Symbol">)</a> <a id="10346" class="Symbol">=</a>
              <a id="10362" href="Relation.Binary.Reasoning.Syntax.html#1510" class="Function Operator">begin</a>
                <a id="10384" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="10392" class="Symbol">(</a><a id="10393" href="Core.Functor.html#495" class="Field">fmap</a> <a id="10398" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="10400" class="Symbol">(</a><a id="10401" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="10408" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="10410" href="Effect.Handle.html#10337" class="Bound">c</a> <a id="10412" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10414" href="Effect.Handle.html#10341" class="Bound">k</a> <a id="10416" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="10417" class="Symbol">))</a>
              <a id="10434" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a> 
                <a id="10455" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="10463" class="Symbol">(</a><a id="10464" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="10471" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="10473" href="Effect.Handle.html#10337" class="Bound">c</a> <a id="10475" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10477" href="Core.Functor.html#495" class="Field">fmap</a> <a id="10482" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="10484" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="10486" href="Effect.Handle.html#10341" class="Bound">k</a> <a id="10488" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="10489" class="Symbol">)</a>
              <a id="10505" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a>
                <a id="10525" class="Symbol">(</a><a id="10526" href="Effect.Handle.html#4345" class="Field">hdl</a> <a id="10530" href="Core.Container.html#1088" class="Function Operator">⟨⊕⟩ᶜ</a> <a id="10535" href="Effect.Handle.html#4873" class="Function">fwd</a><a id="10538" class="Symbol">)</a> <a id="10540" class="Symbol">.</a><a id="10541" href="Core.Container.html#844" class="Field">αᶜ</a> <a id="10544" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="10546" href="Effect.Handle.html#10337" class="Bound">c</a> <a id="10548" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10550" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="10558" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="10560" href="Core.Functor.html#495" class="Field">fmap</a> <a id="10565" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="10567" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="10569" href="Effect.Handle.html#10341" class="Bound">k</a> <a id="10571" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a>
              <a id="10587" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="10590" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">cong</a> <a id="10595" class="Symbol">(λ</a> <a id="10598" href="Effect.Handle.html#10598" class="Bound">○</a> <a id="10600" class="Symbol">→</a> <a id="10602" class="Symbol">(</a><a id="10603" href="Effect.Handle.html#4345" class="Field">hdl</a> <a id="10607" href="Core.Container.html#1088" class="Function Operator">⟨⊕⟩ᶜ</a> <a id="10612" href="Effect.Handle.html#4873" class="Function">fwd</a><a id="10615" class="Symbol">)</a> <a id="10617" class="Symbol">.</a><a id="10618" href="Core.Container.html#844" class="Field">αᶜ</a> <a id="10621" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="10623" href="Effect.Handle.html#10337" class="Bound">c</a> <a id="10625" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10627" href="Effect.Handle.html#10598" class="Bound">○</a> <a id="10629" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a> <a id="10631" class="Symbol">)</a> <a id="10633" class="Symbol">(</a><a id="10634" href="Core.Extensionality.html#201" class="Function">extensionality</a> <a id="10649" class="Symbol">(</a><a id="10650" href="Effect.Handle.html#9834" class="Function">handle′-commute</a> <a id="10666" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="10668" href="Effect.Handle.html#10341" class="Bound">k</a><a id="10669" class="Symbol">))</a> <a id="10672" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a> 
                <a id="10691" class="Symbol">(</a><a id="10692" href="Effect.Handle.html#4345" class="Field">hdl</a> <a id="10696" href="Core.Container.html#1088" class="Function Operator">⟨⊕⟩ᶜ</a> <a id="10701" href="Effect.Handle.html#4873" class="Function">fwd</a><a id="10704" class="Symbol">)</a> <a id="10706" class="Symbol">.</a><a id="10707" href="Core.Container.html#844" class="Field">αᶜ</a> <a id="10710" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="10712" href="Effect.Handle.html#10337" class="Bound">c</a> <a id="10714" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10716" href="Core.Functor.html#495" class="Field">fmap</a> <a id="10721" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="10723" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="10725" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="10733" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="10735" href="Effect.Handle.html#10341" class="Bound">k</a> <a id="10737" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a>
              <a id="10753" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a> 
                 <a id="10775" class="Symbol">(</a><a id="10776" href="Effect.Handle.html#4345" class="Field">hdl</a> <a id="10780" href="Core.Container.html#1088" class="Function Operator">⟨⊕⟩ᶜ</a> <a id="10785" href="Effect.Handle.html#4873" class="Function">fwd</a><a id="10788" class="Symbol">)</a> <a id="10790" class="Symbol">.</a><a id="10791" href="Core.Container.html#844" class="Field">αᶜ</a>  <a id="10795" class="Symbol">(</a><a id="10796" href="Core.Functor.html#495" class="Field">fmap</a> <a id="10801" class="Symbol">{</a><a id="10802" class="Argument">F</a> <a id="10804" class="Symbol">=</a> <a id="10806" href="Core.Container.html#676" class="Record Operator">⟦</a> <a id="10808" class="Symbol">_</a> <a id="10810" href="Core.Container.html#676" class="Record Operator">⟧ᶜ</a><a id="10812" class="Symbol">}</a> <a id="10814" class="Symbol">(</a><a id="10815" href="Core.Functor.html#495" class="Field">fmap</a> <a id="10820" href="Effect.Handle.html#9276" class="Bound">f</a><a id="10821" class="Symbol">)</a> <a id="10823" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="10825" href="Effect.Handle.html#10337" class="Bound">c</a> <a id="10827" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10829" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="10837" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="10839" href="Effect.Handle.html#10341" class="Bound">k</a> <a id="10841" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="10842" class="Symbol">)</a>
              <a id="10858" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">≡⟨</a> <a id="10861" href="Effect.Handle.html#5664" class="Function">hdl-alg-commute</a> <a id="10877" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="10879" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="10881" href="Effect.Handle.html#10337" class="Bound">c</a> <a id="10883" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10885" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="10893" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="10895" href="Effect.Handle.html#10341" class="Bound">k</a> <a id="10897" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a> <a id="10899" href="Relation.Binary.Reasoning.Syntax.html#10986" class="Function">⟩</a>
                <a id="10917" href="Core.Functor.html#495" class="Field">fmap</a> <a id="10922" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="10924" class="Symbol">((</a><a id="10926" href="Effect.Handle.html#4345" class="Field">hdl</a> <a id="10930" href="Core.Container.html#1088" class="Function Operator">⟨⊕⟩ᶜ</a> <a id="10935" href="Effect.Handle.html#4873" class="Function">fwd</a><a id="10938" class="Symbol">)</a> <a id="10940" class="Symbol">.</a><a id="10941" href="Core.Container.html#844" class="Field">αᶜ</a> <a id="10944" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="10946" href="Effect.Handle.html#10337" class="Bound">c</a> <a id="10948" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="10950" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="10958" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="10960" href="Effect.Handle.html#10341" class="Bound">k</a> <a id="10962" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="10963" class="Symbol">)</a> 
              <a id="10980" href="Relation.Binary.Reasoning.Syntax.html#11017" class="Function">≡⟨⟩</a> 
               <a id="11000" href="Core.Functor.html#495" class="Field">fmap</a> <a id="11005" href="Effect.Handle.html#9276" class="Bound">f</a> <a id="11007" class="Symbol">(</a><a id="11008" href="Effect.Handle.html#6051" class="Function">handle′</a> <a id="11016" class="Symbol">(</a><a id="11017" href="Effect.Syntax.Free.html#554" class="InductiveConstructor">impure</a> <a id="11024" href="Core.Container.html#719" class="InductiveConstructor Operator">⟨</a> <a id="11026" href="Effect.Handle.html#10337" class="Bound">c</a> <a id="11028" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="11030" href="Effect.Handle.html#10341" class="Bound">k</a> <a id="11032" href="Core.Container.html#719" class="InductiveConstructor Operator">⟩</a><a id="11033" class="Symbol">))</a>
              <a id="11050" href="Relation.Binary.Reasoning.Syntax.html#12283" class="Function Operator">∎</a>

<a id="11053" class="Comment">-- -- Show that handlers are monad morphisms</a>
<a id="11098" class="Comment">-- handle-mm :</a>
<a id="11113" class="Comment">--   ∀ ⦃ _ : Functor F ⦄</a>
<a id="11138" class="Comment">--   → (H : Handler ε A F)</a>
<a id="11165" class="Comment">--   → Coherent H</a>
<a id="11183" class="Comment">--   → ⦃ i : ε ≲ ε′ ⦄</a>
<a id="11205" class="Comment">--     ----------------------------------------</a>
<a id="11253" class="Comment">--   → MonadMorphism (Free ε′) (M H (i .proj₁))</a>
<a id="11301" class="Comment">-- handle-mm H C ⦃ i ⦄ = record</a>
<a id="11333" class="Comment">--   { Ψ         = handle H (i .proj₂)</a>
<a id="11372" class="Comment">--   ; Ψ-natural = handle-natural (i .proj₂) H </a>
<a id="11420" class="Comment">--   ; resp-unit = extensionality resp-unit′</a>
<a id="11465" class="Comment">--   ; resp-join = λ f g → extensionality λ x → C (i .proj₂) (f x) g</a>
<a id="11534" class="Comment">--   }</a>
<a id="11541" class="Comment">--   where</a>
<a id="11552" class="Comment">--     open ≡-Reasoning</a>
<a id="11576" class="Comment">--     resp-unit′ : ∀ {B : Set} (x : B) → handle H (i .proj₂) (pure x) ≡ return x</a>
<a id="11658" class="Comment">--     resp-unit′ x =</a>
<a id="11680" class="Comment">--       begin</a>
<a id="11695" class="Comment">--         handle H (i .proj₂) (pure x)</a>
<a id="11735" class="Comment">--       ≡⟨⟩ </a>
<a id="11749" class="Comment">--         handle′ H (reorder (i .proj₂) (pure x))</a>
<a id="11800" class="Comment">--       ≡⟨⟩ </a>
<a id="11814" class="Comment">--         handle′ H (pure x)</a>
<a id="11844" class="Comment">--       ≡⟨⟩ </a>
<a id="11858" class="Comment">--         fold-free return (H .hdl ⟨⊕⟩ᶜ fwd) (pure x)</a>
<a id="11913" class="Comment">--       ≡⟨⟩</a>
<a id="11926" class="Comment">--         return x</a>
<a id="11946" class="Comment">--       ∎</a>


<a id="11959" class="Comment">-- -- ℋ-mm :</a>
<a id="11972" class="Comment">-- --   ∀ (H : Handler ε A F)</a>
<a id="12002" class="Comment">-- --   → (C : Coherent H) </a>
<a id="12030" class="Comment">-- --   → ⦃ ε ≲ ε′ ⦄ </a>
<a id="12052" class="Comment">-- --     -----------------------------------------------</a>
<a id="12110" class="Comment">-- --   → MonadMorphism (Free ε′) (const A ⇒ F ⊢ Free ε′)</a>
<a id="12168" class="Comment">-- -- ℋ-mm H C ⦃ i ⦄ = ∘-mm (handle-mm H C) {!!}</a>

<a id="12218" class="Comment">-- -- ℋ-coherent :</a>
<a id="12237" class="Comment">-- --   ∀ {P : Set}</a>
<a id="12257" class="Comment">-- --   → ⦃ _ : ε ≲ ε′ ⦄</a>
<a id="12282" class="Comment">-- --   → ⦃ _ : ∀ {ε} → Monad (const P ⇒ F ⊢ Free ε) ⦄</a>
<a id="12337" class="Comment">-- --   → (H : Handler ε P F)</a>
<a id="12367" class="Comment">-- --   → let module Hd = Handler H in </a>
<a id="12407" class="Comment">-- --     Coherent H</a>
<a id="12428" class="Comment">-- --   → (m : Free ε′ A) (k : A → Free ε′ B)</a>
<a id="12474" class="Comment">-- --     ---------------------------------------------------</a>
<a id="12536" class="Comment">-- --   → Hd.ℋ⟦ m &gt;&gt;= k ⟧ ≡ Hd.ℋ⟦ m ⟧ &gt;&gt;= λ x → Hd.ℋ⟦ k x ⟧</a>
<a id="12596" class="Comment">-- -- ℋ-coherent {ε = ε} {ε′ = ε′} ⦃ i ⦄ H C m k = </a>
<a id="12648" class="Comment">-- --   begin</a>
<a id="12662" class="Comment">-- --     ℋ⟦ (m &gt;&gt;= k) ⟧′</a>
<a id="12688" class="Comment">-- --   ≡⟨⟩ </a>
<a id="12701" class="Comment">-- --     ♯ ∘ (handle H (i .proj₂) (m &gt;&gt;= k))</a>
<a id="12747" class="Comment">-- --   ≡⟨ cong (♯ ∘_) (C (i .proj₂) m k) ⟩</a>
<a id="12791" class="Comment">-- --     ♯ ∘ (handle H (i .proj₂) m &gt;&gt;= λ x p → handle H (i .proj₂) (k x) p)</a>
<a id="12869" class="Comment">-- --   ≡⟨ {!!} ⟩ </a>
<a id="12888" class="Comment">-- --     ♯ ∘ handle H (i .proj₂) m &gt;&gt;= (λ x p → ♯ (handle H (i .proj₂) (k x) p))</a>
<a id="12970" class="Comment">-- --   ≡⟨⟩ </a>
<a id="12983" class="Comment">-- --     (ℋ⟦ m ⟧′ &gt;&gt;= ℋ⟦_⟧′ ∘ k)</a>
<a id="13017" class="Comment">-- --   ∎</a>
<a id="13027" class="Comment">-- --   where</a>
<a id="13041" class="Comment">-- --     ℋ⟦_⟧′ = ℋ⟦ H ⟧</a>
<a id="13066" class="Comment">-- --     instance inst : i .proj₁ ≲ ε′</a>
<a id="13106" class="Comment">-- --     inst = ε , union-comm (i .proj₂)</a>
</pre></body></html>